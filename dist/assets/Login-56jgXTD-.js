import{r as l,u as S,j as e,L as F}from"./index-BxqkWTTL.js";import{s as C,a as w,d as E,b as L,g as q,c as A}from"./firebaseConfig-DFE2fxb7.js";import{F as D,a as I,b as M,c as R,d as T,e as H,f as W}from"./index-BQeCGeTy.js";import{m as c}from"./proxy-Cw7Ubgne.js";function G(){const[t,h]=l.useState({email:"",password:""}),[p,i]=l.useState(""),[n,m]=l.useState(!1),[b,j]=l.useState(!1),[u,k]=l.useState(!1),[o,y]=l.useState({}),x=S(),v=()=>{const a={};return t.email?/\S+@\S+\.\S+/.test(t.email)||(a.email="Please enter a valid email address"):a.email="Email is required",t.password?t.password.length<6&&(a.password="Password must be at least 6 characters"):a.password="Password is required",y(a),Object.keys(a).length===0},f=a=>{const{name:s,value:r}=a.target;h(d=>({...d,[s]:r})),o[s]&&y(d=>({...d,[s]:""})),p&&i("")},N=async a=>{if(a.preventDefault(),!!v()){i(""),m(!0);try{const r=(await C(w,t.email,t.password)).user.uid,d=E(L,"users",r),g=await q(d);if(!g.exists()){i("Account not properly configured. Please contact support.");return}switch(g.data().role){case"student":x("/student-dashboard");break;case"admin":x("/admin-dashboard");break;case"superadmin":x("/superadmin-dashboard");break;default:i("Invalid role assigned. Please contact support.")}h({email:"",password:""})}catch(s){console.error("Login error:",s);let r="Login failed. Please try again.";switch(s.code){case"auth/wrong-password":r="Incorrect password. Please check your password and try again.";break;case"auth/user-not-found":r="No account found with this email address. Please check your email or create a new account.";break;case"auth/invalid-email":r="Invalid email address format.";break;case"auth/user-disabled":r="This account has been disabled. Please contact support.";break;case"auth/too-many-requests":r="Too many failed login attempts. Please try again later or reset your password.";break;case"auth/network-request-failed":r="Network error. Please check your internet connection and try again.";break;default:r="An unexpected error occurred. Please try again or contact support."}i(r)}finally{m(!1)}}},P=async()=>{if(!t.email){i("Please enter your email address to reset your password.");return}if(!/\S+@\S+\.\S+/.test(t.email)){i("Please enter a valid email address.");return}try{m(!0),await A(w,t.email),j(!0),i("")}catch(a){console.error("Password reset error:",a);let s="Failed to send reset email. Please try again.";switch(a.code){case"auth/user-not-found":s="No account found with this email address.";break;case"auth/invalid-email":s="Invalid email address format.";break;case"auth/too-many-requests":s="Too many reset attempts. Please try again later.";break}i(s)}finally{m(!1)}};return e.jsx(c.div,{initial:{opacity:0},animate:{opacity:1},className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:e.jsxs(c.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.1},className:"card w-full max-w-md mx-auto",children:[e.jsxs("div",{className:"bg-gradient-to-r from-primary-500 to-primary-600 p-6 text-center rounded-t-xl",children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Welcome Back"}),e.jsx("p",{className:"text-primary-100 mt-1",children:"Sign in to your account"})]}),e.jsxs("div",{className:"px-6 pt-4",children:[p&&e.jsxs(c.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"status-error p-3 rounded-lg mb-4 text-sm flex items-start",children:[e.jsx(D,{className:"mr-2 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:p})]}),b&&e.jsxs(c.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"status-success p-3 rounded-lg mb-4 text-sm flex items-start",children:[e.jsx(I,{className:"mr-2 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"Password reset link sent to your email. Please check your inbox and spam folder."})]})]}),e.jsxs("form",{onSubmit:N,className:"p-6 space-y-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("label",{className:"text-gray-700 dark:text-gray-300 text-sm font-medium flex items-center",children:[e.jsx(M,{className:"mr-2"})," Email Address"]}),e.jsx("input",{type:"email",name:"email",value:t.email,onChange:f,required:!0,className:`input-field ${o.email?"border-error-500 focus:ring-error-500":""}`,placeholder:"your@email.com","aria-describedby":o.email?"email-error":void 0}),o.email&&e.jsx("p",{id:"email-error",className:"text-error-600 dark:text-error-400 text-xs mt-1",children:o.email})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("label",{className:"text-gray-700 dark:text-gray-300 text-sm font-medium flex items-center",children:[e.jsx(R,{className:"mr-2"})," Password"]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:u?"text":"password",name:"password",value:t.password,onChange:f,required:!0,className:`input-field pr-10 ${o.password?"border-error-500 focus:ring-error-500":""}`,placeholder:"Enter your password","aria-describedby":o.password?"password-error":void 0}),e.jsx("button",{type:"button",onClick:()=>k(!u),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200","aria-label":u?"Hide password":"Show password",children:u?e.jsx(T,{className:"w-5 h-5"}):e.jsx(H,{className:"w-5 h-5"})})]}),o.password&&e.jsx("p",{id:"password-error",className:"text-error-600 dark:text-error-400 text-xs mt-1",children:o.password})]}),e.jsx(c.button,{type:"submit",disabled:n,whileHover:{scale:n?1:1.02},whileTap:{scale:n?1:.98},className:`w-full py-3 px-4 rounded-lg font-semibold text-white transition-colors ${n?"bg-primary-400 cursor-not-allowed":"bg-primary-500 hover:bg-primary-600 focus:ring-2 focus:ring-primary-500 focus:ring-offset-2"} flex items-center justify-center`,children:n?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin h-5 w-5 mr-2 text-white",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Signing In..."]}):e.jsxs(e.Fragment,{children:["Continue ",e.jsx(W,{className:"ml-2"})]})})]}),e.jsxs("div",{className:"px-6 pb-6 flex flex-col sm:flex-row justify-between items-center gap-2",children:[e.jsx("button",{onClick:P,disabled:n,className:"text-primary-600 dark:text-primary-400 hover:text-primary-700 dark:hover:text-primary-300 text-sm font-medium transition-colors disabled:opacity-50",children:"Forgot password?"}),e.jsxs("div",{className:"text-gray-600 dark:text-gray-400 text-sm",children:["Don't have an account?"," ",e.jsx(F,{to:"/register",className:"text-primary-600 dark:text-primary-400 hover:underline font-medium",children:"Sign up"})]})]})]})})}export{G as default};
