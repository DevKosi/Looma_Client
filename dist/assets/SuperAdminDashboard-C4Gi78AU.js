import{r as p,u as fe,j as e}from"./index-DatZN8-u.js";import{i as f,h,b as x,q as ee,o as je,m as ve,w as we,n as te,p as Ne,d as G,u as ze,j as Se,r as Ae,a as ae,g as ke}from"./firebaseConfig-DFE2fxb7.js";import{z as De,A as re,g as Le,B as ie,l as V,q as M,C as I,D as le,E as P,G as ne,e as Y,H as ce,m as Te,j as oe,k as Ee,I as Ce,f as Ue,J as qe,v as de,t as Fe,w as me,y as xe}from"./index-EHIN2_jU.js";import{A as Qe}from"./index-DmtjZn8v.js";import{m as $e}from"./proxy-MyAIwVy1.js";const N={LAST_HOUR:"last_hour",LAST_24_HOURS:"last_24_hours",LAST_WEEK:"last_week",LAST_MONTH:"last_month",ALL_TIME:"all_time"},Q={EXCELLENT:{score:95,color:"green",label:"Excellent"},GOOD:{score:80,color:"blue",label:"Good"},FAIR:{score:65,color:"yellow",label:"Fair"},POOR:{score:50,color:"orange",label:"Poor"},CRITICAL:{score:0,color:"red",label:"Critical"}},Oe=async(r=N.ALL_TIME)=>{try{console.log("üîç Fetching platform statistics...");const c=new Date;let t=null;switch(r){case N.LAST_HOUR:t=new Date(c.getTime()-60*60*1e3);break;case N.LAST_24_HOURS:t=new Date(c.getTime()-24*60*60*1e3);break;case N.LAST_WEEK:t=new Date(c.getTime()-7*24*60*60*1e3);break;case N.LAST_MONTH:t=new Date(c.getTime()-30*24*60*60*1e3);break}const[d,o]=await Promise.all([f(h(x,"users")),f(h(x,"quizzes"))]),a=d.docs.map(i=>({id:i.id,...i.data()})),l={students:a.filter(i=>i.role==="student"||!i.role),admins:a.filter(i=>i.role==="admin"),superAdmins:a.filter(i=>i.role==="superadmin")},y={};a.forEach(i=>{i.department&&(y[i.department]=(y[i.department]||0)+1)});const m=o.docs.map(i=>({id:i.id,...i.data()})),g={approved:m.filter(i=>i.status==="approved"),pending:m.filter(i=>i.status==="pending"),draft:m.filter(i=>i.status==="draft")},w={};m.forEach(i=>{i.department&&(w[i.department]=(w[i.department]||0)+1)});let b=0,u=0;const F={},S={},O=m.map(async i=>{const k=ee(h(x,"quizzes",i.id,"submissions")),E=await f(k);if(S[i.id]={quizTitle:i.title,department:i.department,count:E.size,submissions:E.docs.map(C=>({id:C.id,...C.data()}))},b+=E.size,t){const C=E.docs.filter(J=>(J.data().submittedAt?.toDate?.()||new Date(J.data().submittedAt))>=t).length;u+=C}i.department&&(F[i.department]=(F[i.department]||0)+E.size)});await Promise.all(O);const D=m.length>0?b/m.length:0,H=l.students.length>0?b/l.students.length:0,L={userEngagement:Math.min(H/5*100,100),quizQuality:g.approved.length/Math.max(m.length,1)*100,systemActivity:Math.min(u/Math.max(b*.1,1)*100,100),platformGrowth:Math.min(l.students.length/50*100,100)},T=Object.values(L).reduce((i,k)=>i+k,0)/Object.keys(L).length;let j=Q.CRITICAL;T>=95?j=Q.EXCELLENT:T>=80?j=Q.GOOD:T>=65?j=Q.FAIR:T>=50&&(j=Q.POOR);const B={users:{total:a.length,byRole:l,byDepartment:y,recentSignups:t?a.filter(i=>(i.createdAt?.toDate?.()||new Date(i.createdAt))>=t).length:null},quizzes:{total:m.length,byStatus:g,byDepartment:w,recentCreated:t?m.filter(i=>(i.createdAt?.toDate?.()||new Date(i.createdAt))>=t).length:null},submissions:{total:b,recent:u,byDepartment:F,byQuiz:S,averagePerQuiz:Math.round(D*100)/100,averagePerUser:Math.round(H*100)/100},health:{score:Math.round(T),status:j,factors:L},timeFrame:r,generatedAt:new Date};return console.log("‚úÖ Platform statistics generated successfully"),B}catch(c){return console.error("‚ùå Error fetching platform stats:",c),{error:c.message,users:{total:0,byRole:{},byDepartment:{}},quizzes:{total:0,byStatus:{},byDepartment:{}},submissions:{total:0,recent:0,byDepartment:{},byQuiz:{}},health:{score:0,status:Q.CRITICAL,factors:{}},timeFrame:r,generatedAt:new Date}}},Re=async(r=100)=>{try{console.log("üìù Fetching user activity logs...");const c=await f(h(x,"quizzes")),t=[],d=c.docs.map(async a=>{const l=ee(h(x,"quizzes",a.id,"submissions"),je("submittedAt","desc"),ve(20));(await f(l)).docs.forEach(m=>{const g=m.data();t.push({id:m.id,type:"quiz_submission",action:"Quiz Completed",user:{id:g.userId,name:g.fullName||"Unknown",regNumber:g.regNumber||"Anonymous",department:g.department||"Unknown"},quiz:{id:a.id,title:a.data().title,department:a.data().department},details:{score:g.score,total:g.total,percentage:g.percentage,timeSpent:g.timeSpent},timestamp:g.submittedAt?.toDate?.()||new Date(g.submittedAt||Date.now()),severity:"info",icon:"üìù"})})});await Promise.all(d),t.sort((a,l)=>l.timestamp-a.timestamp);const o=t.slice(0,r);return console.log(`üìã Retrieved ${o.length} activity logs`),o}catch(c){return console.error("‚ùå Error fetching activity logs:",c),[]}},_e=async()=>{try{console.log("üö® Checking for system alerts...");const r=[],c=new Date,t=ee(h(x,"quizzes"),we("status","==","pending")),d=await f(t);d.size>0&&r.push({id:"pending_quizzes",type:"warning",title:"Quizzes Pending Approval",message:`${d.size} quiz(es) are waiting for approval`,count:d.size,action:"Review pending quizzes",severity:"medium",timestamp:c,icon:"‚è≥"});const o=await f(h(x,"users")),a={},l=new Date(c.getTime()-24*60*60*1e3);o.docs.forEach(b=>{const u=b.data();u.department&&(a[u.department]||(a[u.department]={users:0,recentActivity:!1}),a[u.department].users++,u.lastLogin?.toDate?.()>=l&&(a[u.department].recentActivity=!0))}),Object.entries(a).forEach(([b,u])=>{u.users>=5&&!u.recentActivity&&r.push({id:`inactive_dept_${b}`,type:"warning",title:"Inactive Department",message:`${b} department shows no recent activity`,department:b,action:"Check department engagement",severity:"low",timestamp:c,icon:"üò¥"})});const y=await f(h(x,"quizzes")),m=[],g=y.docs.map(async b=>{const u=b.data();if(u.status==="approved"){const S=(await f(h(x,"quizzes",b.id,"submissions"))).size,O=u.createdAt?.toDate?.()||new Date(u.createdAt),D=new Date(c.getTime()-7*24*60*60*1e3);O<D&&S<5&&m.push({title:u.title,department:u.department,submissions:S})}});await Promise.all(g),m.length>0&&r.push({id:"low_engagement",type:"info",title:"Low Quiz Engagement",message:`${m.length} approved quiz(es) have low participation`,count:m.length,details:m,action:"Review quiz engagement strategies",severity:"low",timestamp:c,icon:"üìâ"});const w={high:3,medium:2,low:1};return r.sort((b,u)=>(w[u.severity]||0)-(w[b.severity]||0)),console.log(`üö® Found ${r.length} system alerts`),r}catch(r){return console.error("‚ùå Error fetching system alerts:",r),[]}},Me=async()=>{try{console.log("üè¢ Fetching department analytics...");const[r,c]=await Promise.all([f(h(x,"users")),f(h(x,"quizzes"))]),t={};r.docs.forEach(o=>{const a=o.data();if(a.department&&(t[a.department]||(t[a.department]={name:a.department,users:{total:0,students:0,admins:0},quizzes:{total:0,approved:0,pending:0,draft:0},submissions:{total:0,averageScore:0},lastActivity:null}),t[a.department].users.total++,a.role==="admin"?t[a.department].users.admins++:t[a.department].users.students++,a.lastLogin?.toDate?.())){const l=a.lastLogin.toDate();(!t[a.department].lastActivity||l>t[a.department].lastActivity)&&(t[a.department].lastActivity=l)}});const d=c.docs.map(async o=>{const a=o.data();if(a.department&&t[a.department]){t[a.department].quizzes.total++,t[a.department].quizzes[a.status]++;const l=await f(h(x,"quizzes",o.id,"submissions"));t[a.department].submissions.total+=l.size;let y=0,m=0;if(l.docs.forEach(g=>{const w=g.data();typeof w.percentage=="number"&&(y+=w.percentage,m++)}),m>0){const g=y/m;t[a.department].submissions.averageScore=(t[a.department].submissions.averageScore+g)/2}}});return await Promise.all(d),Object.values(t).forEach(o=>{const a={userBase:Math.min(o.users.total/20*100,100),quizActivity:Math.min(o.quizzes.total/10*100,100),engagement:Math.min(o.submissions.total/50*100,100),performance:o.submissions.averageScore||0};o.healthScore=Object.values(a).reduce((l,y)=>l+y,0)/Object.keys(a).length,o.healthFactors=a}),console.log(`üè¢ Department analytics for ${Object.keys(t).length} departments`),Object.values(t)}catch(r){return console.error("‚ùå Error fetching department analytics:",r),[]}},Pe=async()=>{try{console.log("üíæ Creating system backup...");const r={version:"1.0",timestamp:new Date().toISOString(),collections:{}},c=await f(h(x,"users"));r.collections.users=c.docs.map(d=>({id:d.id,...d.data()}));const t=await f(h(x,"quizzes"));r.collections.quizzes=[];for(const d of t.docs){const o={id:d.id,...d.data(),submissions:[],codes:[]},a=await f(h(x,"quizzes",d.id,"submissions"));o.submissions=a.docs.map(y=>({id:y.id,...y.data()}));const l=await f(h(x,"quizzes",d.id,"codes"));o.codes=l.docs.map(y=>({id:y.id,...y.data()})),r.collections.quizzes.push(o)}return r.metadata={totalUsers:r.collections.users.length,totalQuizzes:r.collections.quizzes.length,totalSubmissions:r.collections.quizzes.reduce((d,o)=>d+o.submissions.length,0),backupSize:JSON.stringify(r).length},console.log("‚úÖ System backup created successfully"),console.log(`üìä Backup contains: ${r.metadata.totalUsers} users, ${r.metadata.totalQuizzes} quizzes, ${r.metadata.totalSubmissions} submissions`),r}catch(r){throw console.error("‚ùå Error creating system backup:",r),new Error(`Backup failed: ${r.message}`)}},He=r=>{const c=[];try{const t=te(h(x,"users"),o=>{console.log("üë• Users collection updated"),r({type:"users_updated",count:o.size})}),d=te(h(x,"quizzes"),o=>{console.log("üìö Quizzes collection updated"),r({type:"quizzes_updated",count:o.size})});return c.push(t,d),()=>{c.forEach(o=>o()),console.log("üîå Real-time listeners cleaned up")}}catch(t){return console.error("‚ùå Error setting up real-time updates:",t),()=>{}}},Be=async r=>{try{return await Ne(G(x,"users",r)),console.log(`‚úÖ User ${r} deleted`),!0}catch(c){throw console.error("‚ùå Error deleting user:",c),c}},Ie=async(r,c)=>{try{return await ze(G(x,"quizzes",r),{status:c,updatedAt:Se()}),console.log(`‚úÖ Quiz ${r} status updated to ${c}`),!0}catch(t){throw console.error("‚ùå Error updating quiz status:",t),t}},Ge=async r=>{try{return await Ae(x,async c=>{c.delete(G(x,"quizzes",r))}),console.log(`‚úÖ Quiz ${r} deleted globally`),!0}catch(c){throw console.error("‚ùå Error deleting quiz globally:",c),c}};function Ye(){const[r,c]=p.useState(null),[t,d]=p.useState("overview"),[o,a]=p.useState({admin:!0,stats:!1,logs:!1,alerts:!1,departments:!1,backup:!1}),[l,y]=p.useState(null),[m,g]=p.useState([]),[w,b]=p.useState([]),[u,F]=p.useState([]),[S,O]=p.useState([]),[D,H]=p.useState([]),[L,T]=p.useState(N.LAST_24_HOURS),[j,B]=p.useState(!1),[i,k]=p.useState(null),[E,C]=p.useState(new Date),[J,W]=p.useState(null),[Je,ue]=p.useState(null),R=fe();p.useEffect(()=>{(async()=>{try{const n=ae.currentUser;if(!n){R("/login");return}const z=await ke(G(x,"users",n.uid));if(!z.exists()||z.data().role!=="superadmin"){R("/login");return}c({uid:n.uid,...z.data()})}catch(n){console.error("Error checking super admin access:",n),R("/login")}finally{a(n=>({...n,admin:!1}))}})()},[R]);const U=p.useCallback(async()=>{a(s=>({...s,stats:!0}));try{const s=await Oe(L);y(s),console.log("üìä Platform stats loaded:",s)}catch{v("Failed to load platform statistics","error")}finally{a(s=>({...s,stats:!1}))}},[L]),K=p.useCallback(async()=>{a(s=>({...s,logs:!0}));try{const s=await Re(50);g(s)}catch{v("Failed to load activity logs","error")}finally{a(s=>({...s,logs:!1}))}},[]),X=p.useCallback(async()=>{a(s=>({...s,alerts:!0}));try{const s=await _e();b(s)}catch{v("Failed to load system alerts","error")}finally{a(s=>({...s,alerts:!1}))}},[]),Z=p.useCallback(async()=>{a(s=>({...s,departments:!0}));try{const s=await Me();F(s)}catch{v("Failed to load department analytics","error")}finally{a(s=>({...s,departments:!1}))}},[]),A=p.useCallback(async()=>{try{const[s,n]=await Promise.all([f(h(x,"users")),f(h(x,"quizzes"))]),z=s.docs.map(_=>({id:_.id,..._.data()})),q=n.docs.map(_=>({id:_.id,..._.data()}));O(z),H(q)}catch{v("Failed to load users and quizzes","error")}},[]);p.useEffect(()=>{r&&(U(),K(),X(),Z(),A())},[r,U,K,X,Z,A]),p.useEffect(()=>j?He(n=>{console.log("üî¥ Real-time update:",n),C(new Date),n.type==="users_updated"?A():n.type==="quizzes_updated"&&(A(),U())}):void 0,[j,A,U]);const v=(s,n="success")=>{k({message:s,type:n}),setTimeout(()=>k(null),5e3)},pe=async()=>{a(s=>({...s,backup:!0}));try{const s=await Pe(),n=new Blob([JSON.stringify(s,null,2)],{type:"application/json"}),z=URL.createObjectURL(n),q=document.createElement("a");q.href=z,q.download=`looma-backup-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(q),q.click(),document.body.removeChild(q),URL.revokeObjectURL(z),v("System backup created and downloaded successfully!")}catch(s){v(`Backup failed: ${s.message}`,"error")}finally{a(s=>({...s,backup:!1}))}},ge=async s=>{if(window.confirm("Are you sure you want to delete this user? This action cannot be undone."))try{await Be(s),v("User deleted successfully"),A()}catch(n){v(`Failed to delete user: ${n.message}`,"error")}},he=async(s,n)=>{try{await Ie(s,n),v(`Quiz status updated to ${n}`),A(),U()}catch(z){v(`Failed to update quiz status: ${z.message}`,"error")}},ye=async s=>{if(window.confirm("Are you sure you want to delete this quiz globally? This will remove all associated data."))try{await Ge(s),v("Quiz deleted successfully"),A(),U()}catch(n){v(`Failed to delete quiz: ${n.message}`,"error")}},be=async()=>{await ae.signOut(),R("/login")},se=async()=>{await Promise.all([U(),K(),X(),Z(),A()]),C(new Date),v("All data refreshed successfully")};return o.admin?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Verifying SuperAdmin access..."})]})}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("header",{className:"bg-white shadow-sm sticky top-0 z-40",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-3 sm:py-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3 sm:gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-lg sm:text-2xl font-bold text-gray-900 flex items-center gap-2 sm:gap-3",children:[e.jsx(De,{className:"text-red-600",size:20}),e.jsx("span",{className:"hidden sm:inline",children:"SuperAdmin Dashboard"}),e.jsx("span",{className:"sm:hidden",children:"SuperAdmin"})]}),e.jsx("p",{className:"text-xs sm:text-base text-gray-600 mt-1",children:"Global platform management and analytics"})]}),e.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>B(!j),className:`flex items-center gap-1 sm:gap-2 px-2 sm:px-3 py-2 rounded-lg text-xs sm:text-sm font-medium transition-colors ${j?"bg-green-100 text-green-800 hover:bg-green-200":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${j?"bg-green-500 animate-pulse":"bg-gray-400"}`}),e.jsx("span",{className:"hidden sm:inline",children:j?"Live":"Offline"})]}),e.jsxs("button",{onClick:se,className:"flex items-center gap-1 sm:gap-2 px-2 sm:px-3 py-2 bg-blue-100 text-blue-800 rounded-lg hover:bg-blue-200 text-xs sm:text-sm font-medium",children:[e.jsx(re,{size:14}),e.jsx("span",{className:"hidden sm:inline",children:"Refresh"})]})]}),e.jsxs("span",{className:"text-xs sm:text-sm text-gray-500 hidden md:block",children:["Updated: ",E.toLocaleTimeString()]}),e.jsxs("button",{onClick:be,className:"flex items-center gap-1 sm:gap-2 text-red-600 hover:text-red-700 text-xs sm:text-sm font-medium",children:[e.jsx(Le,{size:14}),e.jsx("span",{className:"hidden sm:inline",children:"Logout"})]})]})]})})}),e.jsx(Qe,{children:i&&e.jsx($e.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"fixed top-16 sm:top-20 right-4 z-50",children:e.jsx("div",{className:`p-3 sm:p-4 rounded-lg shadow-lg max-w-sm ${i.type==="error"?"bg-red-50 text-red-700 border border-red-200":"bg-green-50 text-green-700 border border-green-200"}`,children:e.jsx("p",{className:"text-sm",children:i.message})})})}),e.jsx("nav",{className:"bg-white shadow-sm",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsx("div",{className:"flex overflow-x-auto scrollbar-hide",children:[{id:"overview",label:"Overview",icon:e.jsx(ie,{size:14})},{id:"analytics",label:"Analytics",icon:e.jsx(V,{size:14})},{id:"users",label:"Users",icon:e.jsx(M,{size:14})},{id:"quizzes",label:"Quizzes",icon:e.jsx(I,{size:14})},{id:"departments",label:"Departments",icon:e.jsx(le,{size:14})},{id:"logs",label:"Logs",icon:e.jsx(P,{size:14})},{id:"maintenance",label:"Maintenance",icon:e.jsx(ne,{size:14})},{id:"leaderboard",label:"Leaderboard",icon:e.jsx(Y,{size:14})}].map(s=>e.jsxs("button",{onClick:()=>d(s.id),className:`px-3 sm:px-4 py-3 font-medium text-xs sm:text-sm flex items-center gap-1 sm:gap-2 whitespace-nowrap flex-shrink-0 border-b-2 transition-colors ${t===s.id?"text-blue-600 border-blue-600":"text-gray-500 hover:text-gray-700 border-transparent"}`,children:[s.icon,e.jsx("span",{className:"hidden sm:inline",children:s.label})]},s.id))})})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 sm:py-6",children:[t==="overview"&&e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[l&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3 sm:gap-0 mb-4 sm:mb-6",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-800 flex items-center gap-2",children:[e.jsx(ce,{className:"text-red-500"}),"System Health"]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("select",{value:L,onChange:s=>T(s.target.value),className:"border border-gray-300 rounded-md px-2 sm:px-3 py-1 text-xs sm:text-sm",children:[e.jsx("option",{value:N.LAST_HOUR,children:"Last Hour"}),e.jsx("option",{value:N.LAST_24_HOURS,children:"Last 24 Hours"}),e.jsx("option",{value:N.LAST_WEEK,children:"Last Week"}),e.jsx("option",{value:N.LAST_MONTH,children:"Last Month"}),e.jsx("option",{value:N.ALL_TIME,children:"All Time"})]})})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 sm:gap-4 mb-4 sm:mb-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:`text-2xl sm:text-4xl font-bold mb-2 ${l.health.status.color==="green"?"text-green-600":l.health.status.color==="blue"?"text-blue-600":l.health.status.color==="yellow"?"text-yellow-600":l.health.status.color==="orange"?"text-orange-600":"text-red-600"}`,children:[l.health.score,"%"]}),e.jsx("div",{className:"text-xs sm:text-sm text-gray-600",children:"Overall Health"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl sm:text-4xl font-bold text-blue-600 mb-2",children:l.users.total}),e.jsx("div",{className:"text-xs sm:text-sm text-gray-600",children:"Total Users"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl sm:text-4xl font-bold text-green-600 mb-2",children:l.quizzes.total}),e.jsx("div",{className:"text-xs sm:text-sm text-gray-600",children:"Total Quizzes"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl sm:text-4xl font-bold text-purple-600 mb-2",children:l.submissions.total}),e.jsx("div",{className:"text-xs sm:text-sm text-gray-600",children:"Total Submissions"})]})]}),e.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4",children:Object.entries(l.health.factors).map(([s,n])=>e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 sm:p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-700 capitalize",children:s.replace(/([A-Z])/g," $1").trim()}),e.jsxs("span",{className:"text-xs sm:text-sm font-bold text-gray-900",children:[Math.round(n),"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${n>=80?"bg-green-500":n>=60?"bg-yellow-500":n>=40?"bg-orange-500":"bg-red-500"}`,style:{width:`${Math.min(n,100)}%`}})})]},s))})]}),l&&e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-6 gap-3 sm:gap-4",children:[e.jsx($,{title:"Active Users",value:l.users.active,icon:e.jsx(M,{className:"text-blue-500",size:16}),trend:l.users.growth}),e.jsx($,{title:"New Users",value:l.users.new,icon:e.jsx(Te,{className:"text-green-500",size:16}),trend:l.users.newGrowth}),e.jsx($,{title:"Active Quizzes",value:l.quizzes.active,icon:e.jsx(oe,{className:"text-green-500",size:16})}),e.jsx($,{title:"Pending",value:l.quizzes.pending,icon:e.jsx(Ee,{className:"text-yellow-500",size:16})}),e.jsx($,{title:"Today's Subs",value:l.submissions.today,icon:e.jsx(Ce,{className:"text-purple-500",size:16})}),e.jsx($,{title:"Avg Score",value:`${l.submissions.averageScore}%`,icon:e.jsx(Y,{className:"text-orange-500",size:16})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-4 sm:p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[e.jsx(P,{className:"text-green-500"}),"Recent Activity"]}),m.length===0?e.jsxs("div",{className:"text-center py-6 sm:py-8 text-gray-500",children:[e.jsx(P,{className:"mx-auto text-4xl mb-4 opacity-50"}),e.jsx("p",{className:"text-sm",children:"No recent activity to display"})]}):e.jsx("div",{className:"space-y-3",children:m.slice(0,5).map((s,n)=>e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:`p-1 rounded-full ${s.type==="user"?"bg-blue-100":s.type==="quiz"?"bg-green-100":s.type==="system"?"bg-purple-100":"bg-gray-100"}`,children:s.type==="user"?e.jsx(M,{size:12}):s.type==="quiz"?e.jsx(Ue,{size:12}):s.type==="system"?e.jsx(I,{size:12}):e.jsx(P,{size:12})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm text-gray-900",children:s.message}),e.jsx("p",{className:"text-xs text-gray-500",children:s.timestamp?.toLocaleString()||"Unknown time"})]})]},n))})]}),w.length>0&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-4 sm:p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[e.jsx(qe,{className:"text-red-500"}),"System Alerts (",w.length,")"]}),e.jsx("div",{className:"space-y-3",children:w.map((s,n)=>e.jsx("div",{className:`p-3 sm:p-4 rounded-lg border-l-4 ${s.severity==="critical"?"bg-red-50 border-red-500":s.severity==="warning"?"bg-yellow-50 border-yellow-500":"bg-blue-50 border-blue-500"}`,children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-gray-900 text-sm",children:s.title}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-600 mt-1",children:s.message})]}),e.jsx("span",{className:`text-xs font-medium px-2 py-1 rounded-full ${s.severity==="critical"?"bg-red-100 text-red-800":s.severity==="warning"?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"}`,children:s.severity})]})},n))})]})]}),t==="analytics"&&e.jsx("div",{className:"space-y-4 sm:space-y-6",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-4 sm:p-6",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[e.jsx(V,{className:"text-blue-500"}),"Platform Analytics"]}),u.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Department"}),e.jsx("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Users"}),e.jsx("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Quizzes"}),e.jsx("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Avg Score"}),e.jsx("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Activity"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:u.map((s,n)=>e.jsxs("tr",{className:n%2===0?"bg-white":"bg-gray-50",children:[e.jsx("td",{className:"px-3 sm:px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.name})}),e.jsx("td",{className:"px-3 sm:px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:s.totalUsers}),e.jsx("td",{className:"px-3 sm:px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:s.totalQuizzes}),e.jsx("td",{className:"px-3 sm:px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-1 max-w-16 sm:max-w-20",children:e.jsx("div",{className:"h-2 bg-gray-200 rounded-full mr-2",children:e.jsx("div",{className:`h-2 rounded-full ${s.averageScore>=70?"bg-green-500":s.averageScore>=50?"bg-yellow-500":"bg-red-500"}`,style:{width:`${Math.min(s.averageScore,100)}%`}})})}),e.jsxs("span",{className:"text-sm font-medium text-gray-900 ml-2",children:[s.averageScore,"%"]})]})}),e.jsx("td",{className:"px-3 sm:px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${s.activityLevel==="high"?"bg-green-100 text-green-800":s.activityLevel==="medium"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:s.activityLevel})})]},s.name))})]})}):e.jsxs("div",{className:"text-center py-6 sm:py-8 text-gray-500",children:[e.jsx(V,{className:"mx-auto text-4xl mb-4 opacity-50"}),e.jsx("p",{className:"text-sm",children:"No analytics data available"})]})]})}),t==="users"&&e.jsx("div",{className:"space-y-4 sm:space-y-6",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3 mb-4 sm:mb-6",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-800 flex items-center gap-2",children:[e.jsx(M,{className:"text-blue-500"}),"User Management (",S.length,")"]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsx("input",{type:"text",placeholder:"Search users...",className:"px-3 py-2 border border-gray-300 rounded-md text-sm"}),e.jsxs("select",{className:"px-3 py-2 border border-gray-300 rounded-md text-sm",children:[e.jsx("option",{value:"",children:"All Roles"}),e.jsx("option",{value:"student",children:"Students"}),e.jsx("option",{value:"admin",children:"Admins"}),e.jsx("option",{value:"superadmin",children:"SuperAdmins"})]})]})]}),S.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),e.jsx("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),e.jsx("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Department"}),e.jsx("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Joined"}),e.jsx("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:S.slice(0,20).map((s,n)=>e.jsxs("tr",{className:n%2===0?"bg-white":"bg-gray-50",children:[e.jsx("td",{className:"px-3 sm:px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.fullName||"Unknown"}),e.jsx("div",{className:"text-xs text-gray-500",children:s.email})]})}),e.jsx("td",{className:"px-3 sm:px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${s.role==="superadmin"?"bg-red-100 text-red-800":s.role==="admin"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:s.role})}),e.jsx("td",{className:"px-3 sm:px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:s.department||"N/A"}),e.jsx("td",{className:"px-3 sm:px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:s.createdAt?.toDate?.()?.toLocaleDateString()||"Unknown"}),e.jsx("td",{className:"px-3 sm:px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-1 sm:gap-2",children:[e.jsx("button",{onClick:()=>W(s),className:"text-blue-600 hover:bg-blue-50 p-1 rounded text-xs",children:e.jsx(de,{size:14})}),e.jsx("button",{onClick:()=>W(s),className:"text-yellow-600 hover:bg-yellow-50 p-1 rounded text-xs",children:e.jsx(Fe,{size:14})}),e.jsx("button",{onClick:()=>ge(s.id),className:"text-red-600 hover:bg-red-50 p-1 rounded text-xs",children:e.jsx(me,{size:14})})]})})]},s.id))})]})}):e.jsxs("div",{className:"text-center py-6 sm:py-8 text-gray-500",children:[e.jsx(M,{className:"mx-auto text-4xl mb-4 opacity-50"}),e.jsx("p",{className:"text-sm",children:"No users found"})]})]})}),t==="quizzes"&&e.jsx("div",{className:"space-y-4 sm:space-y-6",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3 mb-4 sm:mb-6",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-800 flex items-center gap-2",children:[e.jsx(I,{className:"text-green-500"}),"Quiz Management (",D.length,")"]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsx("input",{type:"text",placeholder:"Search quizzes...",className:"px-3 py-2 border border-gray-300 rounded-md text-sm"}),e.jsxs("select",{className:"px-3 py-2 border border-gray-300 rounded-md text-sm",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"approved",children:"Approved"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"draft",children:"Draft"})]})]})]}),D.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Quiz"}),e.jsx("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Department"}),e.jsx("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Questions"}),e.jsx("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:D.slice(0,20).map((s,n)=>e.jsxs("tr",{className:n%2===0?"bg-white":"bg-gray-50",children:[e.jsx("td",{className:"px-3 sm:px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 truncate max-w-32 sm:max-w-none",children:s.title}),e.jsxs("div",{className:"text-xs text-gray-500",children:[s.timeLimit," minutes"]})]})}),e.jsx("td",{className:"px-3 sm:px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${s.status==="approved"?"bg-green-100 text-green-800":s.status==="pending"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:s.status})}),e.jsx("td",{className:"px-3 sm:px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:s.department}),e.jsx("td",{className:"px-3 sm:px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:s.questions?.length||0}),e.jsx("td",{className:"px-3 sm:px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-1 sm:gap-2",children:[e.jsx("button",{onClick:()=>ue(s),className:"text-blue-600 hover:bg-blue-50 p-1 rounded text-xs",children:e.jsx(de,{size:14})}),e.jsx("button",{onClick:()=>he(s.id,"approved"),className:"text-green-600 hover:bg-green-50 p-1 rounded text-xs",children:e.jsx(oe,{size:14})}),e.jsx("button",{onClick:()=>ye(s.id),className:"text-red-600 hover:bg-red-50 p-1 rounded text-xs",children:e.jsx(me,{size:14})})]})})]},s.id))})]})}):e.jsxs("div",{className:"text-center py-6 sm:py-8 text-gray-500",children:[e.jsx(I,{className:"mx-auto text-4xl mb-4 opacity-50"}),e.jsx("p",{className:"text-sm",children:"No quizzes found"})]})]})}),t==="maintenance"&&e.jsx("div",{className:"space-y-4 sm:space-y-6",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-4 sm:p-6",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-800 mb-4 sm:mb-6 flex items-center gap-2",children:[e.jsx(ne,{className:"text-purple-500"}),"System Maintenance"]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6",children:[e.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(xe,{className:"text-blue-500",size:20}),e.jsx("h3",{className:"font-medium text-gray-900",children:"System Backup"})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Create a complete backup of all system data including users, quizzes, and submissions."}),e.jsx("button",{onClick:pe,disabled:o.backup,className:"w-full bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 disabled:opacity-50 flex items-center justify-center gap-2 text-sm",children:o.backup?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Creating Backup..."]}):e.jsxs(e.Fragment,{children:[e.jsx(xe,{size:16}),"Create Backup"]})})]}),e.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(ie,{className:"text-green-500",size:20}),e.jsx("h3",{className:"font-medium text-gray-900",children:"Real-time Monitoring"})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Monitor system performance and user activity in real-time."}),e.jsx("button",{onClick:()=>B(!j),className:`w-full px-4 py-2 rounded-md text-sm font-medium ${j?"bg-green-600 text-white hover:bg-green-700":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:j?"Stop Monitoring":"Start Monitoring"})]}),e.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(ce,{className:"text-red-500",size:20}),e.jsx("h3",{className:"font-medium text-gray-900",children:"Health Check"})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Run a comprehensive system health check and diagnostics."}),e.jsxs("button",{onClick:se,className:"w-full bg-red-600 text-white px-4 py-2 rounded-md hover:bg-red-700 flex items-center justify-center gap-2 text-sm",children:[e.jsx(re,{size:16}),"Run Health Check"]})]})]})]})}),(t==="departments"||t==="logs"||t==="leaderboard")&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-4 sm:p-6",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[t==="departments"&&e.jsx(le,{className:"text-blue-500"}),t==="logs"&&e.jsx(P,{className:"text-green-500"}),t==="leaderboard"&&e.jsx(Y,{className:"text-yellow-500"}),t==="departments"&&"Department Management",t==="logs"&&"Activity Logs",t==="leaderboard"&&"Global Leaderboard"]}),e.jsxs("div",{className:"text-center py-6 sm:py-8 text-gray-500",children:[e.jsx("p",{className:"text-sm",children:"This section is under development"}),e.jsx("p",{className:"text-xs mt-2",children:"Feature will be available in the next update"})]})]})]})]})}const $=({title:r,value:c,icon:t,trend:d})=>e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-3 sm:p-4 border border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"flex-shrink-0",children:t}),d&&e.jsxs("span",{className:`text-xs font-medium ${d>0?"text-green-600":d<0?"text-red-600":"text-gray-600"}`,children:[d>0?"+":"",d,"%"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-lg sm:text-2xl font-bold text-gray-900",children:c}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-600 truncate",children:r})]})]});export{Ye as default};
