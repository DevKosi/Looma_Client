import{R as G,j as e,r as b,u as Ce}from"./index-k15JMTVp.js";import{a as $,d as V,b as N,g as Qe,q as _,h as C,w as W,i as R,r as te,j as H,k as Re,l as Te}from"./firebaseConfig-DFE2fxb7.js";import{g as Ae,p as qe,h as B,l as Fe,q as ae,r as X,s as Ee,f as ie,t as De,u as ce,v as Y,w as $e,n as Oe}from"./index-CBugXPmh.js";import{d as Ue}from"./debugHelpers-DY2nFLsE.js";import{A as Pe}from"./index-DhrJfXwy.js";import{m as A}from"./proxy-B-YSyxNx.js";const Le=()=>/^((?!chrome|android).)*safari/i.test(navigator.userAgent),de=r=>Array.isArray(r)&&r.every(t=>typeof t=="object"&&!(t instanceof Array)),_e=r=>Array.isArray(r)&&r.every(t=>Array.isArray(t)),Be=r=>Array.from(r.map(t=>Object.keys(t)).reduce((t,o)=>new Set([...t,...o]),[])),Ie=(r,t)=>{t=t||Be(r);let o=t,n=t;de(t)&&(o=t.map(d=>d.label),n=t.map(d=>d.key));const i=r.map(d=>n.map(m=>Me(m,d)));return[o,...i]},Me=(r,t)=>{const o=r.replace(/\[([^\]]+)]/g,".$1").split(".").reduce(function(n,i,d,m){const h=n[i];if(h==null)m.splice(1);else return h},t);return o===void 0?r in t?t[r]:"":o},Ve=r=>typeof r>"u"||r===null?"":r,me=(r,t=",",o='"')=>r.filter(n=>n).map(n=>n.map(i=>Ve(i)).map(i=>`${o}${i}${o}`).join(t)).join(`
`),We=(r,t,o,n)=>me(t?[t,...r]:r,o,n),He=(r,t,o,n)=>me(Ie(r,t),o,n),Ze=(r,t,o,n)=>t?`${t.join(o)}
${r}`:r.replace(/"/g,'""'),ue=(r,t,o,n)=>{if(de(r))return He(r,t,o,n);if(_e(r))return We(r,t,o,n);if(typeof r=="string")return Ze(r,t,o);throw new TypeError('Data should be a "String", "Array of arrays" OR "Array of objects" ')},pe=(r,t,o,n,i)=>{const d=ue(r,o,n,i),m=Le()?"application/csv":"text/csv",h=new Blob([t?"\uFEFF":"",d],{type:m}),g=`data:${m};charset=utf-8,${t?"\uFEFF":""}${d}`,p=window.URL||window.webkitURL;return typeof p.createObjectURL>"u"?g:p.createObjectURL(h)};var Z={exports:{}},J,re;function Je(){if(re)return J;re=1;var r="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return J=r,J}var K,ne;function Ke(){if(ne)return K;ne=1;var r=Je();function t(){}function o(){}return o.resetWarningCache=t,K=function(){function n(m,h,g,p,S,l){if(l!==r){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}n.isRequired=n;function i(){return n}var d={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:i,element:n,elementType:n,instanceOf:i,node:n,objectOf:i,oneOf:i,oneOfType:i,shape:i,exact:i,checkPropTypes:o,resetWarningCache:t};return d.PropTypes=d,d},K}var oe;function Xe(){return oe||(oe=1,Z.exports=Ke()()),Z.exports}var w=Xe();const xe={data:w.oneOfType([w.string,w.array,w.func]).isRequired,headers:w.array,target:w.string,separator:w.string,filename:w.string,uFEFF:w.bool,onClick:w.func,asyncOnClick:w.bool,enclosingCharacter:w.string},he={separator:",",filename:"generatedBy_react-csv.csv",uFEFF:!0,asyncOnClick:!1,enclosingCharacter:'"'},Ye={target:"_blank"};class cs extends G.Component{static defaultProps=Object.assign(he,Ye);static propTypes=xe;constructor(t){super(t),this.state={}}buildURI(){return pe(...arguments)}componentDidMount(){const{data:t,headers:o,separator:n,enclosingCharacter:i,uFEFF:d,target:m,specs:h,replace:g}=this.props;this.state.page=window.open(this.buildURI(t,d,o,n,i),m,h,g)}getWindow(){return this.state.page}render(){return null}}let Ge=class extends G.Component{static defaultProps=he;static propTypes=xe;constructor(t){super(t),this.buildURI=this.buildURI.bind(this)}buildURI(){return pe(...arguments)}handleLegacy(t,o=!1){if(window.navigator.msSaveOrOpenBlob){t.preventDefault();const{data:n,headers:i,separator:d,filename:m,enclosingCharacter:h,uFEFF:g}=this.props,p=o&&typeof n=="function"?n():n;let S=new Blob([g?"\uFEFF":"",ue(p,i,d,h)]);return window.navigator.msSaveBlob(S,m),!1}}handleAsyncClick(t){const o=n=>{if(n===!1){t.preventDefault();return}this.handleLegacy(t,!0)};this.props.onClick(t,o)}handleSyncClick(t){if(this.props.onClick(t)===!1){t.preventDefault();return}this.handleLegacy(t)}handleClick(){return t=>{if(typeof this.props.onClick=="function")return this.props.asyncOnClick?this.handleAsyncClick(t):this.handleSyncClick(t);this.handleLegacy(t)}}render(){const{data:t,headers:o,separator:n,filename:i,uFEFF:d,children:m,onClick:h,asyncOnClick:g,enclosingCharacter:p,...S}=this.props,u=typeof window>"u"?"":this.buildURI(t,d,o,n,p);return e.jsx("a",{download:i,...S,ref:j=>this.link=j,target:"_self",href:u,onClick:this.handleClick(),children:m})}};const es=Ge,ms=()=>{const[r,t]=b.useState(null),[o,n]=b.useState([]),[i,d]=b.useState("create"),[m,h]=b.useState({title:"",description:"",timeLimit:30,questionsToRender:"",status:"draft",questions:[]}),[g,p]=b.useState({admin:!0,quizzes:!1,action:!1,results:!1}),[S,l]=b.useState(null),[u,j]=b.useState(null),[T,ge]=b.useState({totalQuizzes:0,activeQuizzes:0,draftQuizzes:0,totalParticipants:0}),[O,ee]=b.useState([]),[ss,ts]=b.useState(!1),[k,U]=b.useState(null),q=Ce(),se=b.useCallback(async()=>{try{const s=$.currentUser;if(!s)return q("/login");const a=V(N,"users",s.uid),c=await Qe(a);c.exists()&&c.data().role==="admin"?(t({...c.data(),uid:s.uid}),P(c.data().department),F(c.data().department)):q("/login")}catch{v("Failed to load admin data","error")}finally{p(s=>({...s,admin:!1}))}},[q]),P=b.useCallback(async s=>{p(a=>({...a,quizzes:!0}));try{const a=_(C(N,"quizzes"),W("department","==",s),W("createdBy","==",$.currentUser.uid)),x=(await R(a)).docs.map(f=>({id:f.id,...f.data()}));n(x)}catch{v("Failed to fetch quizzes","error")}finally{p(a=>({...a,quizzes:!1}))}},[]),F=b.useCallback(async s=>{try{const a=_(C(N,"quizzes"),W("department","==",s)),c=await R(a),x=c.size,f=c.docs.filter(z=>z.data().status==="approved").length,Q=c.docs.filter(z=>z.data().status==="draft").length;let y=0;for(const z of c.docs){const D=C(N,"quizzes",z.id,"submissions"),ke=await R(D);y+=ke.size}ge({totalQuizzes:x,activeQuizzes:f,draftQuizzes:Q,totalParticipants:y})}catch(a){console.error("Error fetching stats:",a)}},[]),M=b.useCallback(async s=>{p(a=>({...a,results:!0}));try{const a=C(N,"quizzes",s,"submissions"),c=await R(a);console.log(`ðŸ“Š FOUND ${c.size} SUBMISSIONS FOR QUIZ ${s}`);const x=c.docs.map((f,Q)=>{const y=f.data();console.log(`Raw submission data ${Q+1}:`,y);const z={id:f.id,...y,timestamp:y.submittedAt?.toDate?y.submittedAt.toDate().toLocaleString():"Unknown",percentage:typeof y.percentage=="number"?y.percentage:0,timeSpent:typeof y.timeSpent=="number"?y.timeSpent:0,email:y.email||"No email",regNumber:y.regNumber||"Anonymous",fullName:y.fullName||"Unknown",department:y.department||"Unknown"};return z.regNumber==="Anonymous"&&console.warn(`âš ï¸ Anonymous regNumber in submission ${Q+1}`),z.percentage===0&&y.score>0&&console.warn(`âš ï¸ Zero percentage despite score > 0 in submission ${Q+1}`),z.email==="No email"&&console.warn(`âš ï¸ Missing email in submission ${Q+1}`),z});console.log("Processed results data:",x),Ue(s),ee(x)}catch(a){console.error("Error fetching results:",a),v("Failed to fetch results","error")}finally{p(a=>({...a,results:!1}))}},[]);b.useEffect(()=>{se()},[se]),b.useEffect(()=>{u&&i==="manage"&&M(u)},[u,i,M]);const v=(s,a="success")=>{l({message:s,type:a}),setTimeout(()=>l(null),5e3)},E=s=>{const{name:a,value:c}=s.target;h(x=>({...x,[a]:c}))},fe=async s=>{s.preventDefault(),p(a=>({...a,action:!0}));try{const a={...m,department:r.department,createdBy:r.uid,createdAt:H(),updatedAt:H()};if(a.questions.length===0)throw new Error("Please add at least one question");const c=await Re(C(N,"quizzes"),a);v("Quiz created successfully!"),h({title:"",description:"",timeLimit:30,status:"draft",questions:[]}),j(c.id),P(r.department),F(r.department)}catch(a){v(a.message,"error")}finally{p(a=>({...a,action:!1}))}},L=async(s,a)=>{p(c=>({...c,action:!0}));try{await te(N,async c=>{const x=V(N,"quizzes",s),f=await c.get(x);if(!f.exists())throw new Error("Quiz does not exist!");if(f.data().createdBy!==$.currentUser.uid)throw new Error("Unauthorized update attempt");c.update(x,{...a,updatedAt:H()})}),v("Quiz updated successfully!"),P(r.department),F(r.department),k?.id===s&&h(c=>({...c,...a}))}catch(c){v(c.message,"error")}finally{p(c=>({...c,action:!1}))}},ye=async s=>{if(window.confirm("Are you sure you want to delete this quiz and all its data?")){p(a=>({...a,action:!0}));try{await te(N,async a=>{const c=V(N,"quizzes",s),x=await a.get(c);if(!x.exists())throw new Error("Quiz does not exist!");if(x.data().createdBy!==$.currentUser.uid)throw new Error("Unauthorized deletion attempt");a.delete(c);const f=_(C(N,"quizzes",s,"codes"));(await R(f)).forEach(D=>{a.delete(D.ref)});const y=_(C(N,"quizzes",s,"submissions"));(await R(y)).forEach(D=>{a.delete(D.ref)})}),v("Quiz and all associated data deleted successfully!"),P(r.department),F(r.department),j(null),U(null)}catch(a){v(`Deletion failed: ${a.message}`,"error")}finally{p(a=>({...a,action:!1}))}}},be=async s=>{if(window.confirm("Permanently delete all results for this quiz?")){p(a=>({...a,action:!0}));try{const a=Te(N),c=C(N,"quizzes",s,"submissions");(await R(c)).forEach(f=>{a.delete(f.ref)}),await a.commit(),ee([]),v("Results cleared successfully"),F(r.department)}catch{v("Failed to clear results","error")}finally{p(a=>({...a,action:!1}))}}},je=s=>{if(!s.text.trim())return;const a=[...m.questions,{...s,id:Date.now().toString()}];h({...m,questions:a})},Ne=(s,a)=>{h({...m,questions:m.questions.map(c=>c.id===s?{...c,...a}:c)})},we=s=>{h({...m,questions:m.questions.filter(a=>a.id!==s)})},ve=s=>{U(s),h({title:s.title,description:s.description,timeLimit:s.timeLimit,questionsToRender:s.questionsToRender||"",status:s.status,questions:s.questions||[]}),d("create")},ze=()=>{U(null),h({title:"",description:"",timeLimit:30,questionsToRender:"",status:"draft",questions:[]})},Se=async()=>{await $.signOut(),q("/login")};return g.admin?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("header",{className:"bg-white shadow-sm sticky top-0 z-10",children:e.jsx("div",{className:"max-w-7xl mx-auto px-3 sm:px-4 py-3 sm:py-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-3",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h1",{className:"text-lg sm:text-xl font-bold text-gray-800 truncate",children:"Admin Dashboard"}),e.jsxs("p",{className:"text-xs sm:text-sm text-gray-600 truncate",children:[r?.department," Department"]})]}),e.jsxs("button",{onClick:Se,className:"flex items-center gap-2 text-red-600 hover:text-red-700 text-sm font-medium px-3 py-2 rounded-lg hover:bg-red-50 transition-colors self-end sm:self-auto",children:[e.jsx(Ae,{size:16}),e.jsx("span",{className:"hidden sm:inline",children:"Logout"}),e.jsx("span",{className:"sm:hidden",children:"Out"})]})]})})}),e.jsxs("main",{className:"max-w-7xl mx-auto px-3 sm:px-4 py-4 sm:py-6",children:[e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4 mb-6 sm:mb-8",children:[e.jsx(I,{icon:e.jsx(qe,{className:"text-blue-500",size:20}),title:"Total Quizzes",value:T.totalQuizzes,loading:g.quizzes}),e.jsx(I,{icon:e.jsx(B,{className:"text-green-500",size:20}),title:"Active Quizzes",value:T.activeQuizzes,loading:g.quizzes}),e.jsx(I,{icon:e.jsx(Fe,{className:"text-yellow-500",size:20}),title:"Draft Quizzes",value:T.draftQuizzes,loading:g.quizzes}),e.jsx(I,{icon:e.jsx(ae,{className:"text-purple-500",size:20}),title:"Total Participants",value:T.totalParticipants,loading:g.quizzes})]}),e.jsx("div",{className:"border-b border-gray-200 mb-6",children:e.jsxs("div",{className:"flex overflow-x-auto scrollbar-hide",children:[e.jsxs("button",{onClick:()=>{d("create"),U(null)},className:`px-3 sm:px-4 py-3 font-medium text-xs sm:text-sm flex items-center gap-1 sm:gap-2 whitespace-nowrap border-b-2 transition-colors ${i==="create"?"text-blue-600 border-blue-600":"text-gray-500 hover:text-gray-700 border-transparent"}`,children:[e.jsx(X,{size:14}),e.jsx("span",{className:"hidden xs:inline",children:k?"Edit":"Create"}),e.jsx("span",{className:"hidden sm:inline",children:" Quiz"})]}),e.jsxs("button",{onClick:()=>d("manage"),className:`px-3 sm:px-4 py-3 font-medium text-xs sm:text-sm flex items-center gap-1 sm:gap-2 whitespace-nowrap border-b-2 transition-colors ${i==="manage"?"text-blue-600 border-blue-600":"text-gray-500 hover:text-gray-700 border-transparent"}`,children:[e.jsx(Ee,{size:14}),e.jsx("span",{className:"hidden xs:inline",children:"Manage"}),e.jsx("span",{className:"hidden sm:inline",children:" Quizzes"})]}),e.jsxs("button",{onClick:()=>d("results"),className:`px-3 sm:px-4 py-3 font-medium text-xs sm:text-sm flex items-center gap-1 sm:gap-2 whitespace-nowrap border-b-2 transition-colors ${i==="results"?"text-blue-600 border-blue-600":"text-gray-500 hover:text-gray-700 border-transparent"}`,children:[e.jsx(B,{size:14}),e.jsx("span",{className:"hidden xs:inline",children:"Results"}),e.jsx("span",{className:"hidden sm:inline",children:"Quiz Results"})]}),e.jsxs("button",{onClick:()=>d("questions"),className:`px-3 sm:px-4 py-3 font-medium text-xs sm:text-sm flex items-center gap-1 sm:gap-2 whitespace-nowrap border-b-2 transition-colors ${i==="questions"?"text-blue-600 border-blue-600":"text-gray-500 hover:text-gray-700 border-transparent"}`,children:[e.jsx(ie,{size:14}),e.jsx("span",{className:"hidden xs:inline",children:"Questions"}),e.jsx("span",{className:"hidden sm:inline",children:"Manage Questions"})]}),e.jsxs("button",{onClick:()=>q("/leaderboard"),className:"px-3 sm:px-4 py-3 font-medium text-xs sm:text-sm flex items-center gap-1 sm:gap-2 whitespace-nowrap text-gray-500 hover:text-gray-700 hover:text-blue-600 transition-colors",children:[e.jsx(ae,{size:14}),e.jsx("span",{className:"hidden xs:inline",children:"Leaderboard"})]})]})}),e.jsx(Pe,{children:S&&e.jsx(A.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:`p-3 rounded-md mb-6 ${S.type==="error"?"bg-red-50 text-red-700":"bg-green-50 text-green-700"}`,children:S.message})}),i==="create"&&e.jsxs(A.div,{initial:{opacity:0},animate:{opacity:1},className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:k?"Edit Quiz":"Create New Quiz"}),e.jsxs("form",{onSubmit:s=>{s.preventDefault(),k?L(k.id,m):fe(s)},className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Title"}),e.jsx("input",{type:"text",name:"title",value:m.title,onChange:E,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),e.jsx("textarea",{name:"description",value:m.description,onChange:E,rows:"3",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Time Limit (minutes)"}),e.jsx("input",{type:"number",name:"timeLimit",min:"1",value:m.timeLimit,onChange:E,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Questions to Render"}),e.jsx("input",{type:"number",name:"questionsToRender",min:"1",value:m.questionsToRender||m.questions.length,onChange:E,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"All questions"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Number of questions to show per quiz attempt"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{name:"status",value:m.status,onChange:E,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"pending",children:"Submit for Approval"}),k?.status==="approved"&&e.jsx("option",{value:"approved",children:"Approved"})]})]})]}),e.jsx(le,{questions:m.questions,addQuestion:je,updateQuestion:Ne,removeQuestion:we}),e.jsxs("div",{className:"pt-2 flex justify-between",children:[k&&e.jsx("button",{type:"button",onClick:ze,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Cancel Editing"}),e.jsx("button",{type:"submit",disabled:g.action||m.questions.length===0,className:`px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md flex items-center justify-center gap-2 disabled:opacity-50 ${k?"ml-auto":"w-full"}`,children:g.action?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin h-4 w-4 mr-2",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Processing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(De,{})," ",k?"Update Quiz":"Create Quiz"]})})]})]})]}),i==="manage"&&e.jsx("div",{className:"space-y-6",children:g.quizzes?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-blue-500"})}):o.length===0?e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6 text-center",children:e.jsx("p",{className:"text-gray-500",children:"No quizzes found"})}):e.jsxs("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"grid grid-cols-12 bg-gray-50 p-4 border-b border-gray-200 font-medium text-sm text-gray-500",children:[e.jsx("div",{className:"col-span-4",children:"Title"}),e.jsx("div",{className:"col-span-2",children:"Status"}),e.jsx("div",{className:"col-span-2",children:"Questions Pool"}),e.jsx("div",{className:"col-span-1",children:"Renders"}),e.jsx("div",{className:"col-span-3",children:"Actions"})]}),o.map(s=>e.jsxs(A.div,{initial:{opacity:0},animate:{opacity:1},className:"grid grid-cols-12 p-4 border-b border-gray-200 items-center hover:bg-gray-50",children:[e.jsxs("div",{className:"col-span-4 font-medium text-gray-800",children:[s.title,e.jsx("p",{className:"text-sm text-gray-500 truncate",children:s.description})]}),e.jsx("div",{className:"col-span-2",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${s.status==="approved"?"bg-green-100 text-green-800":s.status==="pending"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:s.status})}),e.jsxs("div",{className:"col-span-2 text-gray-600",children:[s.questions?.length||0," questions"]}),e.jsx("div",{className:"col-span-1 text-gray-600 text-sm",children:s.questionsToRender||"All"}),e.jsxs("div",{className:"col-span-3 flex items-center gap-2",children:[e.jsx("button",{onClick:()=>ve(s),className:"p-2 text-yellow-600 hover:bg-yellow-50 rounded",title:"Edit Quiz",children:e.jsx(ce,{size:16})}),e.jsx("button",{onClick:()=>ye(s.id),disabled:g.action,className:"p-2 text-red-600 hover:bg-red-50 rounded disabled:opacity-50",title:"Delete Quiz",children:e.jsx(Y,{size:16})})]})]},s.id))]})}),i==="results"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Select Quiz to View Results"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:o.map(s=>e.jsxs(A.div,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>{j(s.id),M(s.id)},className:`p-4 border rounded-lg cursor-pointer transition-all ${u===s.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:bg-gray-50"}`,children:[e.jsx("h3",{className:"font-medium text-gray-800",children:s.title}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:s.description}),e.jsxs("div",{className:"flex justify-between items-center mt-2",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${s.status==="approved"?"bg-green-100 text-green-800":s.status==="pending"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:s.status}),e.jsxs("span",{className:"text-xs text-gray-500",children:[s.questions?.length||0," questions"]})]})]},s.id))})]}),u&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 flex items-center gap-2",children:[e.jsx(B,{})," Results for: ",o.find(s=>s.id===u)?.title]}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Total Submissions: ",O.length]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(es,{data:O.map(s=>({"Registration Number":s.regNumber,"Full Name":s.fullName,Department:s.department,Email:s.email,Score:s.score,Total:s.total,Percentage:s.percentage+"%","Time Spent (mins)":Math.round((s.timeSpent||0)/60),"Submitted At":s.timestamp,"Quiz Title":s.quizTitle})),filename:`quiz-results-${o.find(s=>s.id===u)?.title}-${new Date().toISOString().split("T")[0]}.csv`,className:"flex items-center gap-2 px-4 py-2 bg-blue-100 hover:bg-blue-200 text-blue-800 rounded-lg transition-colors",children:[e.jsx($e,{})," Export CSV"]}),e.jsxs("button",{onClick:()=>be(u),className:"flex items-center gap-2 px-4 py-2 bg-red-100 hover:bg-red-200 text-red-800 rounded-lg transition-colors",children:[e.jsx(Y,{})," Clear All Results"]})]})]}),g.results?e.jsx("div",{className:"flex justify-center py-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading results..."})]})}):O.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(B,{className:"mx-auto text-4xl text-gray-400 mb-4"}),e.jsx("p",{className:"text-gray-500",children:"No submissions found for this quiz"}),e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"Results will appear here when students submit the quiz"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Student Details"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Registration Number"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Department"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Score"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Percentage"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Time Spent"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Submitted At"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:O.map((s,a)=>e.jsxs("tr",{className:a%2===0?"bg-white":"bg-gray-50",children:[e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.fullName||"Unknown"}),e.jsx("div",{className:"text-sm text-gray-500",children:s.email||"No email"})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${s.regNumber==="Anonymous"?"bg-red-100 text-red-800":"bg-green-100 text-green-800"}`,children:s.regNumber||"Anonymous"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:s.department||"Unknown"}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:[e.jsx("span",{className:"text-gray-900",children:s.score}),e.jsxs("span",{className:"text-gray-500",children:[" / ",s.total]})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-1",children:e.jsx("div",{className:`h-2 rounded-full mr-2 ${(s.percentage||0)>=70?"bg-green-200":(s.percentage||0)>=50?"bg-yellow-200":"bg-red-200"}`,children:e.jsx("div",{className:`h-2 rounded-full ${(s.percentage||0)>=70?"bg-green-500":(s.percentage||0)>=50?"bg-yellow-500":"bg-red-500"}`,style:{width:`${Math.min(s.percentage||0,100)}%`}})})}),e.jsxs("span",{className:"text-sm font-medium text-gray-900 ml-2",children:[s.percentage||0,"%"]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:s.timeSpent?`${Math.round(s.timeSpent/60)} mins`:"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:s.timestamp||"Unknown"})]},s.id))})]})})]})]}),i==="questions"&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:u?`Editing: ${o.find(s=>s.id===u)?.title}`:"Select a Quiz to Edit Questions"}),u?e.jsx(le,{questions:o.find(s=>s.id===u)?.questions||[],addQuestion:s=>{const c=[...o.find(x=>x.id===u).questions,s];L(u,{questions:c})},updateQuestion:(s,a)=>{const x=o.find(f=>f.id===u).questions.map(f=>f.id===s?{...f,...a}:f);L(u,{questions:x})},removeQuestion:s=>{const c=o.find(x=>x.id===u).questions.filter(x=>x.id!==s);L(u,{questions:c})}}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(ie,{className:"mx-auto text-3xl mb-2"}),e.jsx("p",{children:"Please select a quiz from the list below to edit questions"}),e.jsx("div",{className:"mt-6 space-y-3 max-w-md mx-auto",children:o.map(s=>e.jsxs(A.div,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>j(s.id),className:"p-3 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50",children:[e.jsx("h3",{className:"font-medium",children:s.title}),e.jsxs("p",{className:"text-sm text-gray-500",children:[s.questions?.length||0," questions â€¢ ",s.status]})]},s.id))})]})]})]})]})},I=({icon:r,title:t,value:o,loading:n})=>e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-3 sm:p-4",children:e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx("div",{className:"p-1.5 sm:p-2 bg-gray-100 rounded-full flex-shrink-0",children:G.cloneElement(r,{size:16})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-xs sm:text-sm text-gray-500 truncate",children:t}),n?e.jsx("div",{className:"h-5 sm:h-6 w-10 sm:w-12 bg-gray-200 rounded mt-1 animate-pulse"}):e.jsx("p",{className:"text-lg sm:text-xl font-semibold text-gray-800",children:o})]})]})}),le=({questions:r,addQuestion:t,updateQuestion:o,removeQuestion:n})=>{const[i,d]=b.useState({text:"",type:"multiple_choice",options:[{id:Date.now().toString(),text:"",correct:!1}],points:1}),m=()=>{if(!i.text.trim())return;const l={...i,id:Date.now().toString()};i.type==="true_false"?(delete l.options,l.correctAnswer=!0):i.type==="short_answer"&&delete l.options,t(l),S()},h=()=>{d({...i,options:[...i.options,{id:Date.now().toString(),text:"",correct:!1}]})},g=(l,u)=>{d({...i,options:i.options.map(j=>j.id===l?{...j,...u}:j)})},p=l=>{d({...i,options:i.options.filter(u=>u.id!==l)})},S=()=>{d({text:"",type:"multiple_choice",options:[{id:Date.now().toString(),text:"",correct:!1}],points:1})};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"space-y-4",children:r.map((l,u)=>e.jsx(A.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-gray-800",children:["Q",u+1,": ",l.text]}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[l.type==="multiple_choice"?`Multiple Choice (${l.options?.filter(j=>j.correct).length} correct)`:l.type==="true_false"?`True/False (Correct: ${l.correctAnswer?"True":"False"})`:"Short Answer"," â€¢ ",l.points," point",l.points!==1?"s":""]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{const j={...l};l.type==="multiple_choice"&&(j.options=l.options.map(T=>({...T}))),d(j)},className:"text-blue-500 hover:text-blue-700 p-1",children:e.jsx(ce,{size:16})}),e.jsx("button",{onClick:()=>n(l.id),className:"text-red-500 hover:text-red-700 p-1",children:e.jsx(Y,{size:16})})]})]})},l.id))}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"font-medium text-blue-800 mb-3",children:"Add New Question"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Question Text"}),e.jsx("input",{type:"text",value:i.text,onChange:l=>d({...i,text:l.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter your question"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Question Type"}),e.jsxs("select",{value:i.type,onChange:l=>d({...i,type:l.target.value,options:l.target.value==="multiple_choice"?[{id:Date.now().toString(),text:"",correct:!1}]:void 0,correctAnswer:l.target.value==="true_false"?!0:void 0}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"multiple_choice",children:"Multiple Choice"}),e.jsx("option",{value:"true_false",children:"True/False"}),e.jsx("option",{value:"short_answer",children:"Short Answer"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Points"}),e.jsx("input",{type:"number",min:"1",value:i.points,onChange:l=>d({...i,points:parseInt(l.target.value)||1}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"})]}),i.type==="multiple_choice"&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Options"}),i.options.map((l,u)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:l.correct,onChange:()=>g(l.id,{correct:!l.correct}),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("input",{type:"text",value:l.text,onChange:j=>g(l.id,{text:j.target.value}),className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",placeholder:`Option ${u+1}`}),e.jsx("button",{onClick:()=>p(l.id),className:"text-red-500 hover:text-red-700 p-1",children:e.jsx(Oe,{size:16})})]},l.id)),e.jsxs("button",{type:"button",onClick:h,className:"flex items-center gap-1 text-sm text-blue-600 hover:text-blue-800",children:[e.jsx(X,{size:14})," Add Option"]})]}),i.type==="true_false"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Correct Answer"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("label",{className:"inline-flex items-center",children:[e.jsx("input",{type:"radio",checked:i.correctAnswer===!0,onChange:()=>d({...i,correctAnswer:!0}),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300"}),e.jsx("span",{className:"ml-2 text-gray-700",children:"True"})]}),e.jsxs("label",{className:"inline-flex items-center",children:[e.jsx("input",{type:"radio",checked:i.correctAnswer===!1,onChange:()=>d({...i,correctAnswer:!1}),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300"}),e.jsx("span",{className:"ml-2 text-gray-700",children:"False"})]})]})]}),e.jsxs("button",{type:"button",onClick:m,disabled:!i.text.trim()||i.type==="multiple_choice"&&i.options.some(l=>!l.text.trim()),className:"flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md disabled:opacity-50",children:[e.jsx(X,{size:16})," Add Question"]})]})]})]})};export{ms as default};
