import{R as he,j as e,r as y,u as Fe}from"./index-BxqkWTTL.js";import{a as O,d as M,b as v,g as De,q as I,h as Q,w as X,i as F,r as le,j as V,k as Ee,l as oe}from"./firebaseConfig-DFE2fxb7.js";import{j as qe,r as $e,k as W,n as Ue,s as ce,t as se,u as Oe,i as de,v as Pe,w as H,x as te,y as J,z as Le,p as _e}from"./index-BQeCGeTy.js";import{d as Be}from"./debugHelpers-DY2nFLsE.js";import{A as Me}from"./index-B_WVIvsn.js";import{m as R}from"./proxy-Cw7Ubgne.js";const Ie=()=>/^((?!chrome|android).)*safari/i.test(navigator.userAgent),ge=i=>Array.isArray(i)&&i.every(a=>typeof a=="object"&&!(a instanceof Array)),Ve=i=>Array.isArray(i)&&i.every(a=>Array.isArray(a)),We=i=>Array.from(i.map(a=>Object.keys(a)).reduce((a,n)=>new Set([...a,...n]),[])),He=(i,a)=>{a=a||We(i);let n=a,l=a;ge(a)&&(n=a.map(d=>d.label),l=a.map(d=>d.key));const r=i.map(d=>l.map(m=>Ze(m,d)));return[n,...r]},Ze=(i,a)=>{const n=i.replace(/\[([^\]]+)]/g,".$1").split(".").reduce(function(l,r,d,m){const g=l[r];if(g==null)m.splice(1);else return g},a);return n===void 0?i in a?a[i]:"":n},Je=i=>typeof i>"u"||i===null?"":i,fe=(i,a=",",n='"')=>i.filter(l=>l).map(l=>l.map(r=>Je(r)).map(r=>`${n}${r}${n}`).join(a)).join(`
`),Ke=(i,a,n,l)=>fe(a?[a,...i]:i,n,l),Xe=(i,a,n,l)=>fe(He(i,a),n,l),Ye=(i,a,n,l)=>a?`${a.join(n)}
${i}`:i.replace(/"/g,'""'),ye=(i,a,n,l)=>{if(ge(i))return Xe(i,a,n,l);if(Ve(i))return Ke(i,a,n,l);if(typeof i=="string")return Ye(i,a,n);throw new TypeError('Data should be a "String", "Array of arrays" OR "Array of objects" ')},be=(i,a,n,l,r)=>{const d=ye(i,n,l,r),m=Ie()?"application/csv":"text/csv",g=new Blob([a?"\uFEFF":"",d],{type:m}),x=`data:${m};charset=utf-8,${a?"\uFEFF":""}${d}`,u=window.URL||window.webkitURL;return typeof u.createObjectURL>"u"?x:u.createObjectURL(g)};var Y={exports:{}},G,me;function Ge(){if(me)return G;me=1;var i="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return G=i,G}var ee,ue;function es(){if(ue)return ee;ue=1;var i=Ge();function a(){}function n(){}return n.resetWarningCache=a,ee=function(){function l(m,g,x,u,C,c){if(c!==i){var N=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw N.name="Invariant Violation",N}}l.isRequired=l;function r(){return l}var d={array:l,bigint:l,bool:l,func:l,number:l,object:l,string:l,symbol:l,any:l,arrayOf:r,element:l,elementType:l,instanceOf:r,node:l,objectOf:r,oneOf:r,oneOfType:r,shape:r,exact:r,checkPropTypes:n,resetWarningCache:a};return d.PropTypes=d,d},ee}var pe;function ss(){return pe||(pe=1,Y.exports=es()()),Y.exports}var z=ss();const je={data:z.oneOfType([z.string,z.array,z.func]).isRequired,headers:z.array,target:z.string,separator:z.string,filename:z.string,uFEFF:z.bool,onClick:z.func,asyncOnClick:z.bool,enclosingCharacter:z.string},Ne={separator:",",filename:"generatedBy_react-csv.csv",uFEFF:!0,asyncOnClick:!1,enclosingCharacter:'"'},ts={target:"_blank"};class ps extends he.Component{static defaultProps=Object.assign(Ne,ts);static propTypes=je;constructor(a){super(a),this.state={}}buildURI(){return be(...arguments)}componentDidMount(){const{data:a,headers:n,separator:l,enclosingCharacter:r,uFEFF:d,target:m,specs:g,replace:x}=this.props;this.state.page=window.open(this.buildURI(a,d,n,l,r),m,g,x)}getWindow(){return this.state.page}render(){return null}}let as=class extends he.Component{static defaultProps=Ne;static propTypes=je;constructor(a){super(a),this.buildURI=this.buildURI.bind(this)}buildURI(){return be(...arguments)}handleLegacy(a,n=!1){if(window.navigator.msSaveOrOpenBlob){a.preventDefault();const{data:l,headers:r,separator:d,filename:m,enclosingCharacter:g,uFEFF:x}=this.props,u=n&&typeof l=="function"?l():l;let C=new Blob([x?"\uFEFF":"",ye(u,r,d,g)]);return window.navigator.msSaveBlob(C,m),!1}}handleAsyncClick(a){const n=l=>{if(l===!1){a.preventDefault();return}this.handleLegacy(a,!0)};this.props.onClick(a,n)}handleSyncClick(a){if(this.props.onClick(a)===!1){a.preventDefault();return}this.handleLegacy(a)}handleClick(){return a=>{if(typeof this.props.onClick=="function")return this.props.asyncOnClick?this.handleAsyncClick(a):this.handleSyncClick(a);this.handleLegacy(a)}}render(){const{data:a,headers:n,separator:l,filename:r,uFEFF:d,children:m,onClick:g,asyncOnClick:x,enclosingCharacter:u,...C}=this.props,N=typeof window>"u"?"":this.buildURI(a,d,n,l,u);return e.jsx("a",{download:r,...C,ref:b=>this.link=b,target:"_self",href:N,onClick:this.handleClick(),children:m})}};const rs=as,hs=()=>{const[i,a]=y.useState(null),[n,l]=y.useState([]),[r,d]=y.useState("create"),[m,g]=y.useState({title:"",description:"",timeLimit:30,questionsToRender:"",status:"draft",questions:[]}),[x,u]=y.useState({admin:!0,quizzes:!1,action:!1,results:!1}),[C,c]=y.useState(null),[N,b]=y.useState(""),[h,A]=y.useState(null),[P,ve]=y.useState({totalQuizzes:0,activeQuizzes:0,draftQuizzes:0,totalParticipants:0}),[D,ae]=y.useState([]),[is,ns]=y.useState(!1),[S,L]=y.useState(null),E=Fe(),re=y.useCallback(async()=>{try{const s=O.currentUser;if(!s)return E("/login");const t=M(v,"users",s.uid),o=await De(t);o.exists()&&o.data().role==="admin"?(a({...o.data(),uid:s.uid}),_(o.data().department),q(o.data().department)):E("/login")}catch{w("Failed to load admin data","error")}finally{u(s=>({...s,admin:!1}))}},[E]),_=y.useCallback(async s=>{u(t=>({...t,quizzes:!0}));try{const t=I(Q(v,"quizzes"),X("department","==",s),X("createdBy","==",O.currentUser.uid)),p=(await F(t)).docs.map(f=>({id:f.id,...f.data()}));l(p)}catch{w("Failed to fetch quizzes","error")}finally{u(t=>({...t,quizzes:!1}))}},[]),q=y.useCallback(async s=>{try{const t=I(Q(v,"quizzes"),X("department","==",s)),o=await F(t),p=o.size,f=o.docs.filter(k=>k.data().status==="approved").length,T=o.docs.filter(k=>k.data().status==="draft").length;let j=0;for(const k of o.docs){const U=Q(v,"quizzes",k.id,"submissions"),Te=await F(U);j+=Te.size}ve({totalQuizzes:p,activeQuizzes:f,draftQuizzes:T,totalParticipants:j})}catch(t){console.error("Error fetching stats:",t)}},[]),K=y.useCallback(async s=>{u(t=>({...t,results:!0}));try{const t=Q(v,"quizzes",s,"submissions"),o=await F(t);console.log(`📊 FOUND ${o.size} SUBMISSIONS FOR QUIZ ${s}`);const p=o.docs.map((f,T)=>{const j=f.data();console.log(`Raw submission data ${T+1}:`,j);const k={id:f.id,...j,timestamp:j.submittedAt?.toDate?j.submittedAt.toDate().toLocaleString():"Unknown",percentage:typeof j.percentage=="number"?j.percentage:0,timeSpent:typeof j.timeSpent=="number"?j.timeSpent:0,email:j.email||"No email",regNumber:j.regNumber||"Anonymous",fullName:j.fullName||"Unknown",department:j.department||"Unknown"};return k.regNumber==="Anonymous"&&console.warn(`⚠️ Anonymous regNumber in submission ${T+1}`),k.percentage===0&&j.score>0&&console.warn(`⚠️ Zero percentage despite score > 0 in submission ${T+1}`),k.email==="No email"&&console.warn(`⚠️ Missing email in submission ${T+1}`),k});console.log("Processed results data:",p),Be(s),ae(p)}catch(t){console.error("Error fetching results:",t),w("Failed to fetch results","error")}finally{u(t=>({...t,results:!1}))}},[]);y.useEffect(()=>{re()},[re]),y.useEffect(()=>{h&&r==="manage"&&K(h)},[h,r,K]);const w=(s,t="success")=>{c({message:s,type:t}),setTimeout(()=>c(null),5e3)},$=s=>{const{name:t,value:o}=s.target;g(p=>({...p,[t]:o}))},we=async s=>{s.preventDefault(),u(t=>({...t,action:!0}));try{const t={...m,department:i.department,createdBy:i.uid,createdAt:V(),updatedAt:V()};if(t.questions.length===0)throw new Error("Please add at least one question");const o=await Ee(Q(v,"quizzes"),t);w("Quiz created successfully!"),g({title:"",description:"",timeLimit:30,status:"draft",questions:[]}),A(o.id),_(i.department),q(i.department)}catch(t){w(t.message,"error")}finally{u(t=>({...t,action:!1}))}},B=async(s,t)=>{u(o=>({...o,action:!0}));try{await le(v,async o=>{const p=M(v,"quizzes",s),f=await o.get(p);if(!f.exists())throw new Error("Quiz does not exist!");if(f.data().createdBy!==O.currentUser.uid)throw new Error("Unauthorized update attempt");o.update(p,{...t,updatedAt:V()})}),w("Quiz updated successfully!"),_(i.department),q(i.department),S?.id===s&&g(o=>({...o,...t}))}catch(o){w(o.message,"error")}finally{u(o=>({...o,action:!1}))}},ie=async s=>{if(window.confirm("Are you sure you want to delete this quiz and all its data?")){u(t=>({...t,action:!0}));try{await le(v,async t=>{const o=M(v,"quizzes",s),p=await t.get(o);if(!p.exists())throw new Error("Quiz does not exist!");if(p.data().createdBy!==O.currentUser.uid)throw new Error("Unauthorized deletion attempt");t.delete(o);const f=I(Q(v,"quizzes",s,"codes"));(await F(f)).forEach(U=>{t.delete(U.ref)});const j=I(Q(v,"quizzes",s,"submissions"));(await F(j)).forEach(U=>{t.delete(U.ref)})}),w("Quiz and all associated data deleted successfully!"),_(i.department),q(i.department),A(null),L(null)}catch(t){w(`Deletion failed: ${t.message}`,"error")}finally{u(t=>({...t,action:!1}))}}},ze=async()=>{if(!(!h||!N.trim())){u(s=>({...s,action:!0}));try{const s=N.split(/\s+/).filter(o=>o.trim().length>0),t=oe(v);s.forEach(o=>{const p=M(Q(v,"quizzes",h,"codes"),o);t.set(p,{code:o,used:!1,usedBy:null,createdAt:V()})}),await t.commit(),w(`${s.length} codes uploaded successfully!`),b("")}catch{w("Failed to upload codes","error")}finally{u(s=>({...s,action:!1}))}}},ke=async s=>{if(window.confirm("Permanently delete all results for this quiz?")){u(t=>({...t,action:!0}));try{const t=oe(v),o=Q(v,"quizzes",s,"submissions");(await F(o)).forEach(f=>{t.delete(f.ref)}),await t.commit(),ae([]),w("Results cleared successfully"),q(i.department)}catch{w("Failed to clear results","error")}finally{u(t=>({...t,action:!1}))}}},Ce=s=>{if(!s.text.trim())return;const t=[...m.questions,{...s,id:Date.now().toString()}];g({...m,questions:t})},Se=(s,t)=>{g({...m,questions:m.questions.map(o=>o.id===s?{...o,...t}:o)})},Qe=s=>{g({...m,questions:m.questions.filter(t=>t.id!==s)})},ne=s=>{L(s),g({title:s.title,description:s.description,timeLimit:s.timeLimit,questionsToRender:s.questionsToRender||"",status:s.status,questions:s.questions||[]}),d("create")},Re=()=>{L(null),g({title:"",description:"",timeLimit:30,questionsToRender:"",status:"draft",questions:[]})},Ae=async()=>{await O.signOut(),E("/login")};return x.admin?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("header",{className:"bg-white shadow-sm sticky top-0 z-10",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-gray-800",children:"Admin Dashboard"}),e.jsxs("p",{className:"text-sm text-gray-600",children:[i?.department," Department"]})]}),e.jsxs("button",{onClick:Ae,className:"flex items-center gap-2 text-red-600 hover:text-red-700 px-3 py-2 rounded-md hover:bg-red-50 transition-colors",children:[e.jsx(qe,{})," Logout"]})]})}),e.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-8",children:[e.jsx(Z,{icon:e.jsx($e,{className:"text-blue-500",size:20}),title:"Total Quizzes",value:P.totalQuizzes,loading:x.quizzes}),e.jsx(Z,{icon:e.jsx(W,{className:"text-green-500",size:20}),title:"Active Quizzes",value:P.activeQuizzes,loading:x.quizzes}),e.jsx(Z,{icon:e.jsx(Ue,{className:"text-yellow-500",size:20}),title:"Draft Quizzes",value:P.draftQuizzes,loading:x.quizzes}),e.jsx(Z,{icon:e.jsx(ce,{className:"text-purple-500",size:20}),title:"Total Participants",value:P.totalParticipants,loading:x.quizzes})]}),e.jsx("div",{className:"flex overflow-x-auto border-b border-gray-200 mb-6 scrollbar-hide",children:e.jsxs("div",{className:"flex space-x-0 min-w-full",children:[e.jsxs("button",{onClick:()=>{d("create"),L(null)},className:`px-4 py-2 font-medium text-sm flex items-center gap-2 whitespace-nowrap flex-shrink-0 ${r==="create"?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700"}`,children:[e.jsx(se,{})," ",S?"Edit Quiz":"Create Quiz"]}),e.jsxs("button",{onClick:()=>d("manage"),className:`px-4 py-2 font-medium text-sm flex items-center gap-2 whitespace-nowrap flex-shrink-0 ${r==="manage"?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700"}`,children:[e.jsx(Oe,{})," Manage Quizzes"]}),e.jsxs("button",{onClick:()=>d("results"),className:`px-4 py-2 font-medium text-sm flex items-center gap-2 whitespace-nowrap flex-shrink-0 ${r==="results"?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700"}`,children:[e.jsx(W,{})," Quiz Results"]}),e.jsxs("button",{onClick:()=>d("questions"),className:`px-4 py-2 font-medium text-sm flex items-center gap-2 whitespace-nowrap flex-shrink-0 ${r==="questions"?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700"}`,children:[e.jsx(de,{})," Manage Questions"]}),e.jsxs("button",{onClick:()=>E("/leaderboard"),className:"px-4 py-2 font-medium text-sm flex items-center gap-2 text-gray-500 hover:text-gray-700 whitespace-nowrap flex-shrink-0",children:[e.jsx(ce,{})," Leaderboard"]})]})}),e.jsx(Me,{children:C&&e.jsx(R.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:`p-3 rounded-md mb-6 ${C.type==="error"?"bg-red-50 text-red-700":"bg-green-50 text-green-700"}`,children:C.message})}),r==="create"&&e.jsxs(R.div,{initial:{opacity:0},animate:{opacity:1},className:"bg-white rounded-lg shadow-sm p-4 sm:p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:S?"Edit Quiz":"Create New Quiz"}),e.jsxs("form",{onSubmit:s=>{s.preventDefault(),S?B(S.id,m):we(s)},className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Title"}),e.jsx("input",{type:"text",name:"title",value:m.title,onChange:$,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),e.jsx("textarea",{name:"description",value:m.description,onChange:$,rows:"3",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Time Limit (minutes)"}),e.jsx("input",{type:"number",name:"timeLimit",min:"1",value:m.timeLimit,onChange:$,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Questions to Render"}),e.jsx("input",{type:"number",name:"questionsToRender",min:"1",value:m.questionsToRender||m.questions.length,onChange:$,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"All questions"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Number of questions to show per quiz attempt"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{name:"status",value:m.status,onChange:$,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"pending",children:"Submit for Approval"}),S?.status==="approved"&&e.jsx("option",{value:"approved",children:"Approved"})]})]})]}),e.jsx(xe,{questions:m.questions,addQuestion:Ce,updateQuestion:Se,removeQuestion:Qe}),e.jsxs("div",{className:"pt-2 flex flex-col sm:flex-row justify-between gap-3",children:[S&&e.jsx("button",{type:"button",onClick:Re,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 order-2 sm:order-1",children:"Cancel Editing"}),e.jsx("button",{type:"submit",disabled:x.action||m.questions.length===0,className:`px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md flex items-center justify-center gap-2 disabled:opacity-50 order-1 sm:order-2 ${S?"sm:ml-auto":"w-full"}`,children:x.action?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin h-4 w-4 mr-2",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Processing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Pe,{})," ",S?"Update Quiz":"Create Quiz"]})})]})]})]}),r==="manage"&&e.jsxs("div",{className:"space-y-6",children:[x.quizzes?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-blue-500"})}):n.length===0?e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6 text-center",children:e.jsx("p",{className:"text-gray-500",children:"No quizzes found"})}):e.jsxs("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"hidden lg:block",children:[e.jsxs("div",{className:"grid grid-cols-12 bg-gray-50 p-4 border-b border-gray-200 font-medium text-sm text-gray-500",children:[e.jsx("div",{className:"col-span-4",children:"Title"}),e.jsx("div",{className:"col-span-2",children:"Status"}),e.jsx("div",{className:"col-span-2",children:"Questions Pool"}),e.jsx("div",{className:"col-span-1",children:"Renders"}),e.jsx("div",{className:"col-span-3",children:"Actions"})]}),n.map(s=>e.jsxs(R.div,{initial:{opacity:0},animate:{opacity:1},className:"grid grid-cols-12 p-4 border-b border-gray-200 items-center hover:bg-gray-50",children:[e.jsxs("div",{className:"col-span-4 font-medium text-gray-800",children:[s.title,e.jsx("p",{className:"text-sm text-gray-500 truncate",children:s.description})]}),e.jsx("div",{className:"col-span-2",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${s.status==="approved"?"bg-green-100 text-green-800":s.status==="pending"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:s.status})}),e.jsxs("div",{className:"col-span-2 text-gray-600",children:[s.questions?.length||0," questions"]}),e.jsx("div",{className:"col-span-1 text-gray-600 text-sm",children:s.questionsToRender||"All"}),e.jsxs("div",{className:"col-span-3 flex items-center gap-2",children:[e.jsx("button",{onClick:()=>{A(s.id),b("")},className:"p-2 text-blue-600 hover:bg-blue-50 rounded",title:"Upload Codes",children:e.jsx(H,{size:16})}),e.jsx("button",{onClick:()=>ne(s),className:"p-2 text-yellow-600 hover:bg-yellow-50 rounded",title:"Edit Quiz",children:e.jsx(te,{size:16})}),e.jsx("button",{onClick:()=>ie(s.id),disabled:x.action,className:"p-2 text-red-600 hover:bg-red-50 rounded disabled:opacity-50",title:"Delete Quiz",children:e.jsx(J,{size:16})})]})]},s.id))]}),e.jsx("div",{className:"lg:hidden",children:n.map(s=>e.jsxs(R.div,{initial:{opacity:0},animate:{opacity:1},className:"p-4 border-b border-gray-200 hover:bg-gray-50",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium text-gray-800",children:s.title}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:s.description})]}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ml-2 ${s.status==="approved"?"bg-green-100 text-green-800":s.status==="pending"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:s.status})]}),e.jsxs("div",{className:"flex justify-between items-center text-sm text-gray-600 mb-3",children:[e.jsxs("span",{children:[s.questions?.length||0," questions"]}),e.jsxs("span",{children:["Renders: ",s.questionsToRender||"All"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>{A(s.id),b("")},className:"p-2 text-blue-600 hover:bg-blue-50 rounded",title:"Upload Codes",children:e.jsx(H,{size:16})}),e.jsx("button",{onClick:()=>ne(s),className:"p-2 text-yellow-600 hover:bg-yellow-50 rounded",title:"Edit Quiz",children:e.jsx(te,{size:16})}),e.jsx("button",{onClick:()=>ie(s.id),disabled:x.action,className:"p-2 text-red-600 hover:bg-red-50 rounded disabled:opacity-50",title:"Delete Quiz",children:e.jsx(J,{size:16})})]})]},s.id))})]}),h&&e.jsxs(R.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:"bg-white rounded-lg shadow-sm p-4 sm:p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[e.jsx(H,{})," Upload Access Codes"]}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Paste codes below (one per line or separated by spaces)"}),e.jsx("textarea",{value:N,onChange:s=>b(s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 mb-4",rows:"6",placeholder:"CODE1 CODE2 CODE3..."}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-end gap-3",children:[e.jsx("button",{onClick:()=>{A(null),b("")},className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 order-2 sm:order-1",children:"Cancel"}),e.jsx("button",{onClick:ze,disabled:!N.trim()||x.action,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md flex items-center gap-2 disabled:opacity-50 order-1 sm:order-2",children:x.action?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin h-4 w-4 mr-2",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Uploading..."]}):e.jsxs(e.Fragment,{children:[e.jsx(H,{})," Upload Codes"]})})]})]})]}),r==="results"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-4 sm:p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Select Quiz to View Results"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:n.map(s=>e.jsxs(R.div,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>{A(s.id),K(s.id)},className:`p-4 border rounded-lg cursor-pointer transition-all ${h===s.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:bg-gray-50"}`,children:[e.jsx("h3",{className:"font-medium text-gray-800",children:s.title}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:s.description}),e.jsxs("div",{className:"flex justify-between items-center mt-2",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${s.status==="approved"?"bg-green-100 text-green-800":s.status==="pending"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:s.status}),e.jsxs("span",{className:"text-xs text-gray-500",children:[s.questions?.length||0," questions"]})]})]},s.id))})]}),h&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 flex items-center gap-2",children:[e.jsx(W,{})," Results for: ",n.find(s=>s.id===h)?.title]}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Total Submissions: ",D.length]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 w-full sm:w-auto",children:[e.jsxs(rs,{data:D.map(s=>({"Registration Number":s.regNumber,"Full Name":s.fullName,Department:s.department,Email:s.email,Score:s.score,Total:s.total,Percentage:s.percentage+"%","Time Spent (mins)":Math.round((s.timeSpent||0)/60),"Submitted At":s.timestamp,"Quiz Title":s.quizTitle})),filename:`quiz-results-${n.find(s=>s.id===h)?.title}-${new Date().toISOString().split("T")[0]}.csv`,className:"flex items-center justify-center gap-2 px-4 py-2 bg-blue-100 hover:bg-blue-200 text-blue-800 rounded-lg transition-colors",children:[e.jsx(Le,{})," Export CSV"]}),e.jsxs("button",{onClick:()=>ke(h),className:"flex items-center justify-center gap-2 px-4 py-2 bg-red-100 hover:bg-red-200 text-red-800 rounded-lg transition-colors",children:[e.jsx(J,{})," Clear All Results"]})]})]}),x.results?e.jsx("div",{className:"flex justify-center py-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading results..."})]})}):D.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(W,{className:"mx-auto text-4xl text-gray-400 mb-4"}),e.jsx("p",{className:"text-gray-500",children:"No submissions found for this quiz"}),e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"Results will appear here when students submit the quiz"})]}):e.jsxs("div",{children:[e.jsx("div",{className:"hidden lg:block overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Student Details"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Registration Number"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Department"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Score"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Percentage"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Time Spent"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Submitted At"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:D.map((s,t)=>e.jsxs("tr",{className:t%2===0?"bg-white":"bg-gray-50",children:[e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.fullName||"Unknown"}),e.jsx("div",{className:"text-sm text-gray-500",children:s.email||"No email"})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${s.regNumber==="Anonymous"?"bg-red-100 text-red-800":"bg-green-100 text-green-800"}`,children:s.regNumber||"Anonymous"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:s.department||"Unknown"}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:[e.jsx("span",{className:"text-gray-900",children:s.score}),e.jsxs("span",{className:"text-gray-500",children:[" / ",s.total]})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-1",children:e.jsx("div",{className:`h-2 rounded-full mr-2 ${(s.percentage||0)>=70?"bg-green-200":(s.percentage||0)>=50?"bg-yellow-200":"bg-red-200"}`,children:e.jsx("div",{className:`h-2 rounded-full ${(s.percentage||0)>=70?"bg-green-500":(s.percentage||0)>=50?"bg-yellow-500":"bg-red-500"}`,style:{width:`${Math.min(s.percentage||0,100)}%`}})})}),e.jsxs("span",{className:"text-sm font-medium text-gray-900 ml-2",children:[s.percentage||0,"%"]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:s.timeSpent?`${Math.round(s.timeSpent/60)} mins`:"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:s.timestamp||"Unknown"})]},s.id))})]})}),e.jsx("div",{className:"lg:hidden space-y-4",children:D.map((s,t)=>e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:s.fullName||"Unknown"}),e.jsx("p",{className:"text-sm text-gray-500",children:s.email||"No email"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-1 mr-2",children:e.jsx("div",{className:`h-2 rounded-full ${(s.percentage||0)>=70?"bg-green-200":(s.percentage||0)>=50?"bg-yellow-200":"bg-red-200"}`,children:e.jsx("div",{className:`h-2 rounded-full ${(s.percentage||0)>=70?"bg-green-500":(s.percentage||0)>=50?"bg-yellow-500":"bg-red-500"}`,style:{width:`${Math.min(s.percentage||0,100)}%`}})})}),e.jsxs("span",{className:"text-sm font-medium text-gray-900",children:[s.percentage||0,"%"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Reg Number:"}),e.jsx("span",{className:`ml-2 inline-flex px-2 py-1 text-xs font-semibold rounded-full ${s.regNumber==="Anonymous"?"bg-red-100 text-red-800":"bg-green-100 text-green-800"}`,children:s.regNumber||"Anonymous"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Department:"}),e.jsx("span",{className:"ml-2 text-gray-900",children:s.department||"Unknown"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Score:"}),e.jsxs("span",{className:"ml-2 text-gray-900",children:[s.score," / ",s.total]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Time:"}),e.jsx("span",{className:"ml-2 text-gray-900",children:s.timeSpent?`${Math.round(s.timeSpent/60)} mins`:"N/A"})]})]}),e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-200",children:e.jsxs("span",{className:"text-xs text-gray-500",children:["Submitted: ",s.timestamp||"Unknown"]})})]},s.id))})]})]})]}),r==="questions"&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-4 sm:p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:h?`Editing: ${n.find(s=>s.id===h)?.title}`:"Select a Quiz to Edit Questions"}),h?e.jsx(xe,{questions:n.find(s=>s.id===h)?.questions||[],addQuestion:s=>{const o=[...n.find(p=>p.id===h).questions,s];B(h,{questions:o})},updateQuestion:(s,t)=>{const p=n.find(f=>f.id===h).questions.map(f=>f.id===s?{...f,...t}:f);B(h,{questions:p})},removeQuestion:s=>{const o=n.find(p=>p.id===h).questions.filter(p=>p.id!==s);B(h,{questions:o})}}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(de,{className:"mx-auto text-3xl mb-2"}),e.jsx("p",{children:"Please select a quiz from the list below to edit questions"}),e.jsx("div",{className:"mt-6 space-y-3 max-w-md mx-auto",children:n.map(s=>e.jsxs(R.div,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>A(s.id),className:"p-3 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50",children:[e.jsx("h3",{className:"font-medium",children:s.title}),e.jsxs("p",{className:"text-sm text-gray-500",children:[s.questions?.length||0," questions • ",s.status]})]},s.id))})]})]})]})]})},Z=({icon:i,title:a,value:n,loading:l})=>e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-gray-100 rounded-full",children:i}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:a}),l?e.jsx("div",{className:"h-6 w-12 bg-gray-200 rounded mt-1 animate-pulse"}):e.jsx("p",{className:"text-xl font-semibold text-gray-800",children:n})]})]})}),xe=({questions:i,addQuestion:a,updateQuestion:n,removeQuestion:l})=>{const[r,d]=y.useState({text:"",type:"multiple_choice",options:[{id:Date.now().toString(),text:"",correct:!1}],points:1}),m=()=>{if(!r.text.trim())return;const c={...r,id:Date.now().toString()};r.type==="true_false"?(delete c.options,c.correctAnswer=!0):r.type==="short_answer"&&delete c.options,a(c),C()},g=()=>{d({...r,options:[...r.options,{id:Date.now().toString(),text:"",correct:!1}]})},x=(c,N)=>{d({...r,options:r.options.map(b=>b.id===c?{...b,...N}:b)})},u=c=>{d({...r,options:r.options.filter(N=>N.id!==c)})},C=()=>{d({text:"",type:"multiple_choice",options:[{id:Date.now().toString(),text:"",correct:!1}],points:1})};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"space-y-4",children:i.map((c,N)=>e.jsx(R.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-gray-800",children:["Q",N+1,": ",c.text]}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[c.type==="multiple_choice"?`Multiple Choice (${c.options?.filter(b=>b.correct).length} correct)`:c.type==="true_false"?`True/False (Correct: ${c.correctAnswer?"True":"False"})`:"Short Answer"," • ",c.points," point",c.points!==1?"s":""]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{const b={...c};c.type==="multiple_choice"&&(b.options=c.options.map(h=>({...h}))),d(b)},className:"text-blue-500 hover:text-blue-700 p-1",children:e.jsx(te,{size:16})}),e.jsx("button",{onClick:()=>l(c.id),className:"text-red-500 hover:text-red-700 p-1",children:e.jsx(J,{size:16})})]})]})},c.id))}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"font-medium text-blue-800 mb-3",children:"Add New Question"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Question Text"}),e.jsx("input",{type:"text",value:r.text,onChange:c=>d({...r,text:c.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter your question"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Question Type"}),e.jsxs("select",{value:r.type,onChange:c=>d({...r,type:c.target.value,options:c.target.value==="multiple_choice"?[{id:Date.now().toString(),text:"",correct:!1}]:void 0,correctAnswer:c.target.value==="true_false"?!0:void 0}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"multiple_choice",children:"Multiple Choice"}),e.jsx("option",{value:"true_false",children:"True/False"}),e.jsx("option",{value:"short_answer",children:"Short Answer"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Points"}),e.jsx("input",{type:"number",min:"1",value:r.points,onChange:c=>d({...r,points:parseInt(c.target.value)||1}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"})]}),r.type==="multiple_choice"&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Options"}),r.options.map((c,N)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:c.correct,onChange:()=>x(c.id,{correct:!c.correct}),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("input",{type:"text",value:c.text,onChange:b=>x(c.id,{text:b.target.value}),className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",placeholder:`Option ${N+1}`}),e.jsx("button",{onClick:()=>u(c.id),className:"text-red-500 hover:text-red-700 p-1",children:e.jsx(_e,{size:16})})]},c.id)),e.jsxs("button",{type:"button",onClick:g,className:"flex items-center gap-1 text-sm text-blue-600 hover:text-blue-800",children:[e.jsx(se,{size:14})," Add Option"]})]}),r.type==="true_false"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Correct Answer"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("label",{className:"inline-flex items-center",children:[e.jsx("input",{type:"radio",checked:r.correctAnswer===!0,onChange:()=>d({...r,correctAnswer:!0}),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300"}),e.jsx("span",{className:"ml-2 text-gray-700",children:"True"})]}),e.jsxs("label",{className:"inline-flex items-center",children:[e.jsx("input",{type:"radio",checked:r.correctAnswer===!1,onChange:()=>d({...r,correctAnswer:!1}),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300"}),e.jsx("span",{className:"ml-2 text-gray-700",children:"False"})]})]})]}),e.jsxs("button",{type:"button",onClick:m,disabled:!r.text.trim()||r.type==="multiple_choice"&&r.options.some(c=>!c.text.trim()),className:"flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md disabled:opacity-50",children:[e.jsx(se,{size:16})," Add Question"]})]})]})]})};export{hs as default};
