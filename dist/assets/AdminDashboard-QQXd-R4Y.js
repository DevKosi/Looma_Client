import{R as de,j as e,r as h,u as Ee}from"./index-BaDfULWJ.js";import{a as q,d as P,b as j,g as De,q as _,h as R,w as W,i as F,j as B,k as qe,r as ae,l as re}from"./firebaseConfig-DFE2fxb7.js";import{g as Ue,p as Le,l as H,k as Oe,q as $e,r as M,s as ie,t as K,u as Pe,f as _e,v as Be,w as X,x as ne,y as Ie,n as me}from"./index-MX0La52G.js";import{d as Me}from"./debugHelpers-DY2nFLsE.js";import{A as Ve}from"./index-DNKPhB1f.js";import{m as ue}from"./proxy-CMbDJxWG.js";const We=()=>/^((?!chrome|android).)*safari/i.test(navigator.userAgent),xe=r=>Array.isArray(r)&&r.every(t=>typeof t=="object"&&!(t instanceof Array)),He=r=>Array.isArray(r)&&r.every(t=>Array.isArray(t)),Ye=r=>Array.from(r.map(t=>Object.keys(t)).reduce((t,o)=>new Set([...t,...o]),[])),Ze=(r,t)=>{t=t||Ye(r);let o=t,n=t;xe(t)&&(o=t.map(d=>d.label),n=t.map(d=>d.key));const i=r.map(d=>n.map(m=>Je(m,d)));return[o,...i]},Je=(r,t)=>{const o=r.replace(/\[([^\]]+)]/g,".$1").split(".").reduce(function(n,i,d,m){const p=n[i];if(p==null)m.splice(1);else return p},t);return o===void 0?r in t?t[r]:"":o},Ke=r=>typeof r>"u"||r===null?"":r,pe=(r,t=",",o='"')=>r.filter(n=>n).map(n=>n.map(i=>Ke(i)).map(i=>`${o}${i}${o}`).join(t)).join(`
`),Xe=(r,t,o,n)=>pe(t?[t,...r]:r,o,n),Ge=(r,t,o,n)=>pe(Ze(r,t),o,n),es=(r,t,o,n)=>t?`${t.join(o)}
${r}`:r.replace(/"/g,'""'),he=(r,t,o,n)=>{if(xe(r))return Ge(r,t,o,n);if(He(r))return Xe(r,t,o,n);if(typeof r=="string")return es(r,t,o);throw new TypeError('Data should be a "String", "Array of arrays" OR "Array of objects" ')},ge=(r,t,o,n,i)=>{const d=he(r,o,n,i),m=We()?"application/csv":"text/csv",p=new Blob([t?"\uFEFF":"",d],{type:m}),x=`data:${m};charset=utf-8,${t?"\uFEFF":""}${d}`,u=window.URL||window.webkitURL;return typeof u.createObjectURL>"u"?x:u.createObjectURL(p)};var Y={exports:{}},Z,le;function ss(){if(le)return Z;le=1;var r="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return Z=r,Z}var J,oe;function ts(){if(oe)return J;oe=1;var r=ss();function t(){}function o(){}return o.resetWarningCache=t,J=function(){function n(m,p,x,u,k,l){if(l!==r){var f=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw f.name="Invariant Violation",f}}n.isRequired=n;function i(){return n}var d={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:i,element:n,elementType:n,instanceOf:i,node:n,objectOf:i,oneOf:i,oneOfType:i,shape:i,exact:i,checkPropTypes:o,resetWarningCache:t};return d.PropTypes=d,d},J}var ce;function as(){return ce||(ce=1,Y.exports=ts()()),Y.exports}var z=as();const fe={data:z.oneOfType([z.string,z.array,z.func]).isRequired,headers:z.array,target:z.string,separator:z.string,filename:z.string,uFEFF:z.bool,onClick:z.func,asyncOnClick:z.bool,enclosingCharacter:z.string},ye={separator:",",filename:"generatedBy_react-csv.csv",uFEFF:!0,asyncOnClick:!1,enclosingCharacter:'"'},rs={target:"_blank"};class ps extends de.Component{static defaultProps=Object.assign(ye,rs);static propTypes=fe;constructor(t){super(t),this.state={}}buildURI(){return ge(...arguments)}componentDidMount(){const{data:t,headers:o,separator:n,enclosingCharacter:i,uFEFF:d,target:m,specs:p,replace:x}=this.props;this.state.page=window.open(this.buildURI(t,d,o,n,i),m,p,x)}getWindow(){return this.state.page}render(){return null}}let is=class extends de.Component{static defaultProps=ye;static propTypes=fe;constructor(t){super(t),this.buildURI=this.buildURI.bind(this)}buildURI(){return ge(...arguments)}handleLegacy(t,o=!1){if(window.navigator.msSaveOrOpenBlob){t.preventDefault();const{data:n,headers:i,separator:d,filename:m,enclosingCharacter:p,uFEFF:x}=this.props,u=o&&typeof n=="function"?n():n;let k=new Blob([x?"\uFEFF":"",he(u,i,d,p)]);return window.navigator.msSaveBlob(k,m),!1}}handleAsyncClick(t){const o=n=>{if(n===!1){t.preventDefault();return}this.handleLegacy(t,!0)};this.props.onClick(t,o)}handleSyncClick(t){if(this.props.onClick(t)===!1){t.preventDefault();return}this.handleLegacy(t)}handleClick(){return t=>{if(typeof this.props.onClick=="function")return this.props.asyncOnClick?this.handleAsyncClick(t):this.handleSyncClick(t);this.handleLegacy(t)}}render(){const{data:t,headers:o,separator:n,filename:i,uFEFF:d,children:m,onClick:p,asyncOnClick:x,enclosingCharacter:u,...k}=this.props,f=typeof window>"u"?"":this.buildURI(t,d,o,n,u);return e.jsx("a",{download:i,...k,ref:b=>this.link=b,target:"_self",href:f,onClick:this.handleClick(),children:m})}};const ns=is,gs=()=>{const[r,t]=h.useState(null),[o,n]=h.useState([]),[i,d]=h.useState("create"),[m,p]=h.useState({title:"",description:"",timeLimit:30,questionsToRender:"",status:"draft",questions:[]}),[x,u]=h.useState({admin:!0,quizzes:!1,action:!1,results:!1}),[k,l]=h.useState(null),[f,b]=h.useState(""),[v,A]=h.useState(null),[U,be]=h.useState({totalQuizzes:0,activeQuizzes:0,draftQuizzes:0,totalParticipants:0}),[L,G]=h.useState([]),[je,ee]=h.useState(!1),[S,V]=h.useState(null),O=Ee(),se=h.useCallback(async()=>{try{const s=q.currentUser;if(!s)return O("/login");const a=P(j,"users",s.uid),c=await De(a);c.exists()&&c.data().role==="admin"?(t({...c.data(),uid:s.uid}),$(c.data().department),T(c.data().department)):O("/login")}catch{w("Failed to load admin data","error")}finally{u(s=>({...s,admin:!1}))}},[O]),$=h.useCallback(async s=>{u(a=>({...a,quizzes:!0}));try{const a=_(R(j,"quizzes"),W("department","==",s),W("createdBy","==",q.currentUser.uid)),y=(await F(a)).docs.map(N=>({id:N.id,...N.data()}));n(y)}catch{w("Failed to fetch quizzes","error")}finally{u(a=>({...a,quizzes:!1}))}},[]),T=h.useCallback(async s=>{try{const a=_(R(j,"quizzes"),W("department","==",s)),c=await F(a),y=c.size,N=c.docs.filter(C=>C.data().status==="approved").length,Q=c.docs.filter(C=>C.data().status==="draft").length;let g=0;for(const C of c.docs){const D=R(j,"quizzes",C.id,"submissions"),Te=await F(D);g+=Te.size}be({totalQuizzes:y,activeQuizzes:N,draftQuizzes:Q,totalParticipants:g})}catch(a){console.error("Error fetching stats:",a)}},[]),te=h.useCallback(async s=>{u(a=>({...a,results:!0}));try{const a=R(j,"quizzes",s,"submissions"),c=await F(a);console.log(`ðŸ“Š FOUND ${c.size} SUBMISSIONS FOR QUIZ ${s}`);const y=c.docs.map((N,Q)=>{const g=N.data();console.log(`Raw submission data ${Q+1}:`,g);const C={id:N.id,...g,timestamp:g.submittedAt?.toDate?g.submittedAt.toDate().toLocaleString():"Unknown",percentage:typeof g.percentage=="number"?g.percentage:0,timeSpent:typeof g.timeSpent=="number"?g.timeSpent:0,email:g.email||"No email",regNumber:g.regNumber||"Anonymous",fullName:g.fullName||"Unknown",department:g.department||"Unknown"};return C.regNumber==="Anonymous"&&console.warn(`âš ï¸ Anonymous regNumber in submission ${Q+1}`),C.percentage===0&&g.score>0&&console.warn(`âš ï¸ Zero percentage despite score > 0 in submission ${Q+1}`),C.email==="No email"&&console.warn(`âš ï¸ Missing email in submission ${Q+1}`),C});console.log("Processed results data:",y),Me(s),G(y)}catch(a){console.error("Error fetching results:",a),w("Failed to fetch results","error")}finally{u(a=>({...a,results:!1}))}},[]);h.useEffect(()=>{se()},[se]),h.useEffect(()=>{v&&i==="manage"&&te(v)},[v,i,te]);const w=(s,a="success")=>{l({message:s,type:a}),setTimeout(()=>l(null),5e3)},E=s=>{const{name:a,value:c}=s.target;p(y=>({...y,[a]:c}))},Ne=async s=>{s.preventDefault(),u(a=>({...a,action:!0}));try{const a={...m,department:r.department,createdBy:r.uid,createdAt:B(),updatedAt:B()};if(a.questions.length===0)throw new Error("Please add at least one question");const c=await qe(R(j,"quizzes"),a);w("Quiz created successfully!"),p({title:"",description:"",timeLimit:30,status:"draft",questions:[]}),A(c.id),$(r.department),T(r.department)}catch(a){w(a.message,"error")}finally{u(a=>({...a,action:!1}))}},ve=async(s,a)=>{u(c=>({...c,action:!0}));try{await ae(j,async c=>{const y=P(j,"quizzes",s),N=await c.get(y);if(!N.exists())throw new Error("Quiz does not exist!");if(N.data().createdBy!==q.currentUser.uid)throw new Error("Unauthorized update attempt");c.update(y,{...a,updatedAt:B()})}),w("Quiz updated successfully!"),$(r.department),T(r.department),S?.id===s&&p(c=>({...c,...a}))}catch(c){w(c.message,"error")}finally{u(c=>({...c,action:!1}))}},we=async s=>{if(window.confirm("Are you sure you want to delete this quiz and all its data?")){u(a=>({...a,action:!0}));try{await ae(j,async a=>{const c=P(j,"quizzes",s),y=await a.get(c);if(!y.exists())throw new Error("Quiz does not exist!");if(y.data().createdBy!==q.currentUser.uid)throw new Error("Unauthorized deletion attempt");a.delete(c);const N=_(R(j,"quizzes",s,"codes"));(await F(N)).forEach(D=>{a.delete(D.ref)});const g=_(R(j,"quizzes",s,"submissions"));(await F(g)).forEach(D=>{a.delete(D.ref)})}),w("Quiz and all associated data deleted successfully!"),$(r.department),T(r.department),A(null),V(null)}catch(a){w(`Deletion failed: ${a.message}`,"error")}finally{u(a=>({...a,action:!1}))}}},ze=async()=>{if(!(!v||!f.trim())){u(s=>({...s,action:!0}));try{const s=f.split(/\s+/).filter(c=>c.trim().length>0),a=re(j);s.forEach(c=>{const y=P(R(j,"quizzes",v,"codes"),c);a.set(y,{code:c,used:!1,usedBy:null,createdAt:B()})}),await a.commit(),w(`${s.length} codes uploaded successfully!`),b("")}catch{w("Failed to upload codes","error")}finally{u(s=>({...s,action:!1}))}}},Ce=async s=>{if(window.confirm("Permanently delete all results for this quiz?")){u(a=>({...a,action:!0}));try{const a=re(j),c=R(j,"quizzes",s,"submissions");(await F(c)).forEach(N=>{a.delete(N.ref)}),await a.commit(),G([]),w("Results cleared successfully"),T(r.department)}catch{w("Failed to clear results","error")}finally{u(a=>({...a,action:!1}))}}},ke=s=>{if(!s.text.trim())return;const a=[...m.questions,{...s,id:Date.now().toString()}];p({...m,questions:a})},Se=(s,a)=>{p({...m,questions:m.questions.map(c=>c.id===s?{...c,...a}:c)})},Re=s=>{p({...m,questions:m.questions.filter(a=>a.id!==s)})},Qe=s=>{V(s),p({title:s.title,description:s.description,timeLimit:s.timeLimit,questionsToRender:s.questionsToRender||"",status:s.status,questions:s.questions||[]}),d("create")},Fe=()=>{V(null),p({title:"",description:"",timeLimit:30,questionsToRender:"",status:"draft",questions:[]})},Ae=async()=>{await q.signOut(),O("/login")};return x.admin?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("header",{className:"bg-white shadow-sm sticky top-0 z-10",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-3 sm:py-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3 sm:gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg sm:text-xl font-bold text-gray-800",children:"Admin Dashboard"}),e.jsxs("p",{className:"text-xs sm:text-sm text-gray-600",children:[r?.department," Department"]})]}),e.jsxs("button",{onClick:Ae,className:"flex items-center gap-2 text-red-600 hover:text-red-700 text-sm",children:[e.jsx(Ue,{}),e.jsx("span",{className:"hidden sm:inline",children:"Logout"})]})]})})}),e.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 sm:py-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 sm:gap-4 mb-6 sm:mb-8",children:[e.jsx(I,{icon:e.jsx(Le,{className:"text-blue-500",size:18}),title:"Total Quizzes",value:U.totalQuizzes,loading:x.quizzes}),e.jsx(I,{icon:e.jsx(H,{className:"text-green-500",size:18}),title:"Active Quizzes",value:U.activeQuizzes,loading:x.quizzes}),e.jsx(I,{icon:e.jsx(Oe,{className:"text-orange-500",size:18}),title:"Draft Quizzes",value:U.draftQuizzes,loading:x.quizzes}),e.jsx(I,{icon:e.jsx($e,{className:"text-purple-500",size:18}),title:"Participants",value:U.totalParticipants,loading:x.quizzes})]}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm mb-6 overflow-hidden",children:e.jsx("div",{className:"flex overflow-x-auto scrollbar-hide",children:[{id:"create",label:"Create Quiz",icon:e.jsx(M,{size:16})},{id:"manage",label:"Manage Quizzes",icon:e.jsx(ie,{size:16})}].map(s=>e.jsxs("button",{onClick:()=>d(s.id),className:`px-4 sm:px-6 py-3 sm:py-4 font-medium text-xs sm:text-sm flex items-center gap-2 whitespace-nowrap flex-shrink-0 border-b-2 transition-colors ${i===s.id?"text-blue-600 border-blue-600 bg-blue-50":"text-gray-500 hover:text-gray-700 border-transparent"}`,children:[s.icon," ",s.label]},s.id))})}),e.jsx(Ve,{children:k&&e.jsx(ue.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:`p-3 sm:p-4 rounded-md mb-4 sm:mb-6 ${k.type==="error"?"bg-red-50 text-red-700":"bg-green-50 text-green-700"}`,children:k.message})}),i==="create"&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm",children:[e.jsxs("div",{className:"px-4 sm:px-6 py-4 sm:py-5 border-b border-gray-200",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-800 flex items-center gap-2",children:[S?e.jsx(K,{className:"text-blue-500"}):e.jsx(M,{className:"text-green-500"}),S?"Edit Quiz":"Create New Quiz"]}),S&&e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Editing: ",S.title]})]}),e.jsx("div",{className:"p-4 sm:p-6",children:e.jsxs("form",{onSubmit:S?s=>{s.preventDefault(),ve(S.id,m)}:Ne,className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Quiz Title *"}),e.jsx("input",{type:"text",name:"title",value:m.title,onChange:E,placeholder:"Enter quiz title",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Time Limit (minutes) *"}),e.jsx("input",{type:"number",name:"timeLimit",value:m.timeLimit,onChange:E,min:"1",max:"300",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),e.jsx("textarea",{name:"description",value:m.description,onChange:E,placeholder:"Enter quiz description",rows:"3",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Questions to Render"}),e.jsx("input",{type:"number",name:"questionsToRender",value:m.questionsToRender,onChange:E,placeholder:"Leave empty to render all",min:"1",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),e.jsxs("select",{name:"status",value:m.status,onChange:E,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",children:[e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"approved",children:"Approved"})]})]})]}),e.jsxs("div",{className:"border-t pt-6",children:[e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3 mb-4",children:e.jsxs("h3",{className:"text-lg font-medium text-gray-800",children:["Questions (",m.questions.length,")"]})}),e.jsx(ls,{questions:m.questions,addQuestion:ke,updateQuestion:Se,removeQuestion:Re})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-end gap-3 pt-6 border-t",children:[S&&e.jsx("button",{type:"button",onClick:Fe,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 text-sm",children:"Cancel Edit"}),e.jsx("button",{type:"submit",disabled:x.action||m.questions.length===0,className:"px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 flex items-center gap-2 text-sm font-medium",children:x.action?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),S?"Updating...":"Creating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Pe,{size:16}),S?"Update Quiz":"Create Quiz"]})})]})]})})]}),i==="manage"&&e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm",children:[e.jsx("div",{className:"px-4 sm:px-6 py-4 sm:py-5 border-b border-gray-200",children:e.jsxs("h2",{className:"text-lg font-semibold text-gray-800 flex items-center gap-2",children:[e.jsx(ie,{className:"text-blue-500"}),"My Quizzes (",o.length,")"]})}),x.quizzes?e.jsxs("div",{className:"p-6 sm:p-8 text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Loading quizzes..."})]}):o.length===0?e.jsxs("div",{className:"p-6 sm:p-8 text-center",children:[e.jsx(_e,{className:"mx-auto text-4xl text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-700 mb-2",children:"No Quizzes Yet"}),e.jsx("p",{className:"text-gray-500 text-sm mb-4",children:"Create your first quiz to get started!"}),e.jsx("button",{onClick:()=>d("create"),className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 text-sm",children:"Create Quiz"})]}):e.jsx("div",{className:"divide-y divide-gray-100",children:o.map(s=>e.jsx("div",{className:"p-4 sm:p-6 hover:bg-gray-50",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3 sm:gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-3 mb-2",children:[e.jsx("h3",{className:"font-semibold text-gray-900 truncate",children:s.title}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${s.status==="approved"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:s.status}),e.jsxs("span",{className:"text-xs text-gray-500",children:[s.timeLimit," min"]}),e.jsxs("span",{className:"text-xs text-gray-500",children:[s.questions?.length||0," questions"]})]})]}),e.jsx("p",{className:"text-sm text-gray-600 line-clamp-2 mb-2",children:s.description}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[e.jsxs("span",{children:["Created: ",s.createdAt?.toDate?.()?.toLocaleDateString()||"Unknown"]}),s.updatedAt&&e.jsxs("span",{children:["Updated: ",s.updatedAt?.toDate?.()?.toLocaleDateString()]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsxs("button",{onClick:()=>Qe(s),className:"flex items-center justify-center gap-1 px-3 py-2 text-blue-600 hover:bg-blue-50 rounded-md text-xs sm:text-sm",children:[e.jsx(K,{size:14}),e.jsx("span",{className:"hidden sm:inline",children:"Edit"})]}),e.jsxs("button",{onClick:()=>{A(s.id),ee(!0)},className:"flex items-center justify-center gap-1 px-3 py-2 text-green-600 hover:bg-green-50 rounded-md text-xs sm:text-sm",children:[e.jsx(Be,{size:14}),e.jsx("span",{className:"hidden sm:inline",children:"Results"})]}),e.jsxs("button",{onClick:()=>we(s.id),className:"flex items-center justify-center gap-1 px-3 py-2 text-red-600 hover:bg-red-50 rounded-md text-xs sm:text-sm",children:[e.jsx(X,{size:14}),e.jsx("span",{className:"hidden sm:inline",children:"Delete"})]})]})]})},s.id))})]}),v&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm",children:[e.jsxs("div",{className:"px-4 sm:px-6 py-4 sm:py-5 border-b border-gray-200",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 flex items-center gap-2",children:[e.jsx(ne,{className:"text-green-500"}),"Upload Access Codes"]}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Selected Quiz: ",o.find(s=>s.id===v)?.title]})]}),e.jsxs("div",{className:"p-4 sm:p-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Access Codes (one per line)"}),e.jsx("textarea",{value:f,onChange:s=>b(s.target.value),placeholder:"Enter access codes, one per line...",rows:"4",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsx("button",{onClick:ze,disabled:x.action||!f.trim(),className:"flex-1 sm:flex-none bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 disabled:opacity-50 flex items-center justify-center gap-2 text-sm",children:x.action?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Uploading..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ne,{size:16}),"Upload Codes"]})}),e.jsx("button",{onClick:()=>{A(null),b("")},className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 text-sm",children:"Cancel"})]})]})]}),je&&v&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm",children:[e.jsx("div",{className:"px-4 sm:px-6 py-4 sm:py-5 border-b border-gray-200",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 flex items-center gap-2",children:[e.jsx(H,{className:"text-blue-500"}),"Quiz Results"]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:o.find(s=>s.id===v)?.title})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[L.length>0&&e.jsxs(ns,{data:L,filename:`quiz-results-${v}.csv`,className:"bg-green-600 text-white px-3 py-2 rounded-md hover:bg-green-700 text-xs sm:text-sm flex items-center justify-center gap-1",children:[e.jsx(Ie,{size:14}),e.jsx("span",{className:"hidden sm:inline",children:"Export CSV"})]}),e.jsxs("button",{onClick:()=>Ce(v),disabled:x.action,className:"bg-red-600 text-white px-3 py-2 rounded-md hover:bg-red-700 disabled:opacity-50 text-xs sm:text-sm flex items-center justify-center gap-1",children:[e.jsx(X,{size:14}),e.jsx("span",{className:"hidden sm:inline",children:"Clear Results"})]}),e.jsx("button",{onClick:()=>{ee(!1),A(null)},className:"px-3 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 text-xs sm:text-sm",children:e.jsx(me,{size:14})})]})]})}),e.jsx("div",{className:"p-4 sm:p-6",children:x.results?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Loading results..."})]}):L.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(H,{className:"mx-auto text-4xl text-gray-400 mb-4"}),e.jsx("h4",{className:"text-lg font-medium text-gray-700 mb-2",children:"No Results Yet"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Students haven't taken this quiz yet."})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Student"}),e.jsx("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Score"}),e.jsx("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Percentage"}),e.jsx("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Time"}),e.jsx("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:L.map((s,a)=>e.jsxs("tr",{className:a%2===0?"bg-white":"bg-gray-50",children:[e.jsx("td",{className:"px-3 sm:px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.fullName}),e.jsx("div",{className:"text-xs text-gray-500",children:s.regNumber})]})}),e.jsxs("td",{className:"px-3 sm:px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[s.score,"/",s.total]}),e.jsx("td",{className:"px-3 sm:px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-1 max-w-16 sm:max-w-20",children:e.jsx("div",{className:`h-2 rounded-full mr-2 ${s.percentage>=70?"bg-green-200":s.percentage>=50?"bg-yellow-200":"bg-red-200"}`,children:e.jsx("div",{className:`h-2 rounded-full ${s.percentage>=70?"bg-green-500":s.percentage>=50?"bg-yellow-500":"bg-red-500"}`,style:{width:`${Math.min(s.percentage,100)}%`}})})}),e.jsxs("span",{className:"text-sm font-medium text-gray-900 ml-2",children:[s.percentage,"%"]})]})}),e.jsxs("td",{className:"px-3 sm:px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[Math.floor(s.timeSpent/60),"m ",s.timeSpent%60,"s"]}),e.jsx("td",{className:"px-3 sm:px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:s.timestamp})]},s.id))})]})})})]})]})]})]})},I=({icon:r,title:t,value:o,loading:n})=>e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-3 sm:p-4 border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-600 truncate",children:t}),n?e.jsx("div",{className:"h-6 sm:h-8 bg-gray-200 rounded animate-pulse mt-1"}):e.jsx("p",{className:"text-lg sm:text-2xl font-bold text-gray-900",children:o})]}),e.jsx("div",{className:"flex-shrink-0",children:r})]})}),ls=({questions:r,addQuestion:t,updateQuestion:o,removeQuestion:n})=>{const[i,d]=h.useState({text:"",type:"multiple_choice",options:[{id:Date.now().toString(),text:"",correct:!1}],points:1}),m=()=>{if(!i.text.trim())return;const l={...i,id:Date.now().toString()};i.type==="true_false"?(delete l.options,l.correctAnswer=!0):i.type==="short_answer"&&delete l.options,t(l),k()},p=()=>{d({...i,options:[...i.options,{id:Date.now().toString(),text:"",correct:!1}]})},x=(l,f)=>{d({...i,options:i.options.map(b=>b.id===l?{...b,...f}:b)})},u=l=>{d({...i,options:i.options.filter(f=>f.id!==l)})},k=()=>{d({text:"",type:"multiple_choice",options:[{id:Date.now().toString(),text:"",correct:!1}],points:1})};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"space-y-4",children:r.map((l,f)=>e.jsx(ue.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-gray-800",children:["Q",f+1,": ",l.text]}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[l.type==="multiple_choice"?`Multiple Choice (${l.options?.filter(b=>b.correct).length} correct)`:l.type==="true_false"?`True/False (Correct: ${l.correctAnswer?"True":"False"})`:"Short Answer"," â€¢ ",l.points," point",l.points!==1?"s":""]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{const b={...l};l.type==="multiple_choice"&&(b.options=l.options.map(v=>({...v}))),d(b)},className:"text-blue-500 hover:text-blue-700 p-1",children:e.jsx(K,{size:16})}),e.jsx("button",{onClick:()=>n(l.id),className:"text-red-500 hover:text-red-700 p-1",children:e.jsx(X,{size:16})})]})]})},l.id))}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"font-medium text-blue-800 mb-3",children:"Add New Question"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Question Text"}),e.jsx("input",{type:"text",value:i.text,onChange:l=>d({...i,text:l.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter your question"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Question Type"}),e.jsxs("select",{value:i.type,onChange:l=>d({...i,type:l.target.value,options:l.target.value==="multiple_choice"?[{id:Date.now().toString(),text:"",correct:!1}]:void 0,correctAnswer:l.target.value==="true_false"?!0:void 0}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"multiple_choice",children:"Multiple Choice"}),e.jsx("option",{value:"true_false",children:"True/False"}),e.jsx("option",{value:"short_answer",children:"Short Answer"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Points"}),e.jsx("input",{type:"number",min:"1",value:i.points,onChange:l=>d({...i,points:parseInt(l.target.value)||1}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"})]}),i.type==="multiple_choice"&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Options"}),i.options.map((l,f)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:l.correct,onChange:()=>x(l.id,{correct:!l.correct}),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("input",{type:"text",value:l.text,onChange:b=>x(l.id,{text:b.target.value}),className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",placeholder:`Option ${f+1}`}),e.jsx("button",{onClick:()=>u(l.id),className:"text-red-500 hover:text-red-700 p-1",children:e.jsx(me,{size:16})})]},l.id)),e.jsxs("button",{type:"button",onClick:p,className:"flex items-center gap-1 text-sm text-blue-600 hover:text-blue-800",children:[e.jsx(M,{size:14})," Add Option"]})]}),i.type==="true_false"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Correct Answer"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("label",{className:"inline-flex items-center",children:[e.jsx("input",{type:"radio",checked:i.correctAnswer===!0,onChange:()=>d({...i,correctAnswer:!0}),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300"}),e.jsx("span",{className:"ml-2 text-gray-700",children:"True"})]}),e.jsxs("label",{className:"inline-flex items-center",children:[e.jsx("input",{type:"radio",checked:i.correctAnswer===!1,onChange:()=>d({...i,correctAnswer:!1}),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300"}),e.jsx("span",{className:"ml-2 text-gray-700",children:"False"})]})]})]}),e.jsxs("button",{type:"button",onClick:m,disabled:!i.text.trim()||i.type==="multiple_choice"&&i.options.some(l=>!l.text.trim()),className:"flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md disabled:opacity-50",children:[e.jsx(M,{size:16})," Add Question"]})]})]})]})};export{gs as default};
